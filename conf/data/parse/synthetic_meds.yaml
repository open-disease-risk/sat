_target_: sat.data.dataset.parse_meds.meds
source: ${data_source}
processed_dir: ${modelhub}
train_ratio: 0.7
validation_ratio: 0.15
test_ratio: 0.15
n_bins: 20
encode: ordinal
strategy: quantile
name: ${dataset}
kfold: ${cv.kfold}
time_field: days
# Scaling options for numerical features
scale_numerics: true
scale_method: "standard"  # or "min_max"
min_scale_numerics: 1.0  # Used with min_max scaling

# Custom labelers using parallel processing
labelers:
  # Mortality labeler to identify death events
  - type: mortality
    name: death
    max_followup_days: 1095  # 3 years follow-up
    death_codes: ["SNOMED/419620001"]  # Using MEDS_DEATH_CODE from the schema
    enrollment_codes: ["ENROLLMENT"]
  
  # Hospitalization event labeler
  - type: custom_event
    name: hospitalization
    max_followup_days: 1095
    event_definition:
      codes: ["ENC_INPATIENT"]
    enrollment_codes: ["ENROLLMENT"]

  # Diabetes complications event labeler
  - type: custom_event
    name: diabetes_complications
    max_followup_days: 1095
    event_definition:
      and:
        - codes: ["ICD10:E11"]  # Type 2 diabetes
        - or:
            - codes: ["ICD10:I50"]  # Heart failure
            - codes: ["ICD10:N18"]  # Kidney disease
    enrollment_codes: ["ENROLLMENT"]

  # Risk factor labeler to identify conditions
  - type: risk_factor
    name: risk_factors
    custom_codes:
      icd10:
        hypertension: ["I15.9"]
        diabetes: ["E11"]
        heart_failure: ["I50"]
      rxnorm:
        diabetes: ["A10"]
