{
  "best_global_step": 150,
  "best_metric": 0.4850838516256202,
  "best_model_checkpoint": "./data/model-hub/hsa_synthetic/deephit_trial_1749866999/checkpoint-150",
  "epoch": 30.0,
  "eval_steps": 10,
  "global_step": 150,
  "is_hyper_param_search": false,
  "is_local_process_zero": true,
  "is_world_process_zero": true,
  "log_history": [
    {
      "epoch": 2.0,
      "grad_norm": 1173.630126953125,
      "learning_rate": 4.094324217872359e-06,
      "loss": 14.8705,
      "step": 10
    },
    {
      "epoch": 4.0,
      "grad_norm": 1579.7728271484375,
      "learning_rate": 8.188648435744718e-06,
      "loss": 5.8392,
      "step": 20
    },
    {
      "epoch": 6.0,
      "grad_norm": 797.6046752929688,
      "learning_rate": 1.2282972653617078e-05,
      "loss": 6.0208,
      "step": 30
    },
    {
      "epoch": 8.0,
      "grad_norm": 615.1942138671875,
      "learning_rate": 1.6377296871489437e-05,
      "loss": 5.8858,
      "step": 40
    },
    {
      "epoch": 8.0,
      "eval_brier_0th_event": 0.6345332860946655,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.47027817368507385,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.5517844927022388,
      "eval_ipcw_0th_event": 0.48298765073405964,
      "eval_ipcw_0th_event_0.25": 0.4893873929977417,
      "eval_ipcw_0th_event_0.50": 0.4904285669326782,
      "eval_ipcw_0th_event_0.75": 0.4803413450717926,
      "eval_ipcw_0th_event_1.00": 0.47961536049842834,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.4678566025763966,
      "eval_ipcw_1th_event_0.25": 0.4837193191051483,
      "eval_ipcw_1th_event_0.50": 0.4628806710243225,
      "eval_ipcw_1th_event_0.75": 0.46981745958328247,
      "eval_ipcw_1th_event_1.00": 0.4649466276168823,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.47542212665522815,
      "eval_loss": 2.4708712100982666,
      "eval_runtime": 1.8606,
      "eval_samples_per_second": 603.019,
      "eval_steps_per_second": 1.612,
      "step": 40
    },
    {
      "epoch": 10.0,
      "grad_norm": 448.632568359375,
      "learning_rate": 1.6372912566565302e-05,
      "loss": 5.7142,
      "step": 50
    },
    {
      "epoch": 10.0,
      "eval_brier_0th_event": 0.640695333480835,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.4559067189693451,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.5476021282882084,
      "eval_ipcw_0th_event": 0.4831508431169722,
      "eval_ipcw_0th_event_0.25": 0.49027255177497864,
      "eval_ipcw_0th_event_0.50": 0.4912150502204895,
      "eval_ipcw_0th_event_0.75": 0.48042890429496765,
      "eval_ipcw_0th_event_1.00": 0.4793478846549988,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.4664399472333617,
      "eval_ipcw_1th_event_0.25": 0.48472556471824646,
      "eval_ipcw_1th_event_0.50": 0.46446865797042847,
      "eval_ipcw_1th_event_0.75": 0.4683929979801178,
      "eval_ipcw_1th_event_1.00": 0.46145936846733093,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.4747953951751669,
      "eval_loss": 2.5155110359191895,
      "eval_runtime": 0.4521,
      "eval_samples_per_second": 2481.829,
      "eval_steps_per_second": 6.636,
      "step": 50
    },
    {
      "epoch": 12.0,
      "grad_norm": 1181.7802734375,
      "learning_rate": 1.635976434661642e-05,
      "loss": 6.3046,
      "step": 60
    },
    {
      "epoch": 12.0,
      "eval_brier_0th_event": 0.6451256275177002,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.44201669096946716,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.5428029711325844,
      "eval_ipcw_0th_event": 0.48410782984431167,
      "eval_ipcw_0th_event_0.25": 0.49159714579582214,
      "eval_ipcw_0th_event_0.50": 0.4919474124908447,
      "eval_ipcw_0th_event_0.75": 0.4815497100353241,
      "eval_ipcw_0th_event_1.00": 0.4802107810974121,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.4667357678635645,
      "eval_ipcw_1th_event_0.25": 0.48652735352516174,
      "eval_ipcw_1th_event_0.50": 0.466902494430542,
      "eval_ipcw_1th_event_0.75": 0.46960362792015076,
      "eval_ipcw_1th_event_1.00": 0.459652841091156,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.47542179885393815,
      "eval_loss": 2.2417240142822266,
      "eval_runtime": 0.4716,
      "eval_samples_per_second": 2379.095,
      "eval_steps_per_second": 6.361,
      "step": 60
    },
    {
      "epoch": 14.0,
      "grad_norm": 708.5064697265625,
      "learning_rate": 1.633786629108604e-05,
      "loss": 5.6351,
      "step": 70
    },
    {
      "epoch": 14.0,
      "eval_brier_0th_event": 0.6437873244285583,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.4308316111564636,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.5365040377120568,
      "eval_ipcw_0th_event": 0.48608743270089416,
      "eval_ipcw_0th_event_0.25": 0.49670445919036865,
      "eval_ipcw_0th_event_0.50": 0.49344074726104736,
      "eval_ipcw_0th_event_0.75": 0.48380085825920105,
      "eval_ipcw_0th_event_1.00": 0.48147645592689514,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.4675580413592641,
      "eval_ipcw_1th_event_0.25": 0.489635705947876,
      "eval_ipcw_1th_event_0.50": 0.4717261791229248,
      "eval_ipcw_1th_event_0.75": 0.47123250365257263,
      "eval_ipcw_1th_event_1.00": 0.4573432207107544,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.47682273703007916,
      "eval_loss": 2.2612557411193848,
      "eval_runtime": 0.4716,
      "eval_samples_per_second": 2379.372,
      "eval_steps_per_second": 6.362,
      "step": 70
    },
    {
      "epoch": 16.0,
      "grad_norm": 785.989990234375,
      "learning_rate": 1.630724184896051e-05,
      "loss": 5.7257,
      "step": 80
    },
    {
      "epoch": 16.0,
      "eval_brier_0th_event": 0.6463214755058289,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.41805124282836914,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.5313230073037198,
      "eval_ipcw_0th_event": 0.4864911799796958,
      "eval_ipcw_0th_event_0.25": 0.49823281168937683,
      "eval_ipcw_0th_event_0.50": 0.49350762367248535,
      "eval_ipcw_0th_event_0.75": 0.48391708731651306,
      "eval_ipcw_0th_event_1.00": 0.4819747805595398,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.46701283843118974,
      "eval_ipcw_1th_event_0.25": 0.49119067192077637,
      "eval_ipcw_1th_event_0.50": 0.4745027720928192,
      "eval_ipcw_1th_event_0.75": 0.47216641902923584,
      "eval_ipcw_1th_event_1.00": 0.45354777574539185,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.47675200920544286,
      "eval_loss": 2.270409345626831,
      "eval_runtime": 0.4598,
      "eval_samples_per_second": 2440.281,
      "eval_steps_per_second": 6.525,
      "step": 80
    },
    {
      "epoch": 18.0,
      "grad_norm": 280.95001220703125,
      "learning_rate": 1.626792381365952e-05,
      "loss": 5.639,
      "step": 90
    },
    {
      "epoch": 18.0,
      "eval_brier_0th_event": 0.6539814472198486,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.4046315848827362,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.52836343790327,
      "eval_ipcw_0th_event": 0.48936309911933873,
      "eval_ipcw_0th_event_0.25": 0.5002292394638062,
      "eval_ipcw_0th_event_0.50": 0.4973253607749939,
      "eval_ipcw_0th_event_0.75": 0.4870661795139313,
      "eval_ipcw_0th_event_1.00": 0.48439788818359375,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.4650307820149253,
      "eval_ipcw_1th_event_0.25": 0.48987311124801636,
      "eval_ipcw_1th_event_0.50": 0.4759460985660553,
      "eval_ipcw_1th_event_0.75": 0.470977783203125,
      "eval_ipcw_1th_event_1.00": 0.44912660121917725,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.4771969405671321,
      "eval_loss": 2.2930870056152344,
      "eval_runtime": 0.4845,
      "eval_samples_per_second": 2315.645,
      "eval_steps_per_second": 6.192,
      "step": 90
    },
    {
      "epoch": 20.0,
      "grad_norm": 194.55967712402344,
      "learning_rate": 1.6219954287920076e-05,
      "loss": 6.1079,
      "step": 100
    },
    {
      "epoch": 20.0,
      "eval_brier_0th_event": 0.6581795811653137,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.3929295539855957,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.5245513526466358,
      "eval_ipcw_0th_event": 0.49309870459316074,
      "eval_ipcw_0th_event_0.25": 0.5033146739006042,
      "eval_ipcw_0th_event_0.50": 0.5029166340827942,
      "eval_ipcw_0th_event_0.75": 0.4907008111476898,
      "eval_ipcw_0th_event_1.00": 0.487446665763855,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.4644482002997225,
      "eval_ipcw_1th_event_0.25": 0.48910900950431824,
      "eval_ipcw_1th_event_0.50": 0.47790199518203735,
      "eval_ipcw_1th_event_0.75": 0.47090545296669006,
      "eval_ipcw_1th_event_1.00": 0.44696006178855896,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.47877345244644165,
      "eval_loss": 2.113949775695801,
      "eval_runtime": 0.472,
      "eval_samples_per_second": 2377.003,
      "eval_steps_per_second": 6.356,
      "step": 100
    },
    {
      "epoch": 22.0,
      "grad_norm": 5189.80712890625,
      "learning_rate": 1.616338463871185e-05,
      "loss": 5.7371,
      "step": 110
    },
    {
      "epoch": 22.0,
      "eval_brier_0th_event": 0.6598621606826782,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.37995195388793945,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.5188483953836646,
      "eval_ipcw_0th_event": 0.49670013085882014,
      "eval_ipcw_0th_event_0.25": 0.5043303966522217,
      "eval_ipcw_0th_event_0.50": 0.5083360075950623,
      "eval_ipcw_0th_event_0.75": 0.49458542466163635,
      "eval_ipcw_0th_event_1.00": 0.4905814230442047,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.4643208333640641,
      "eval_ipcw_1th_event_0.25": 0.48783862590789795,
      "eval_ipcw_1th_event_0.50": 0.4792383909225464,
      "eval_ipcw_1th_event_0.75": 0.4718708097934723,
      "eval_ipcw_1th_event_1.00": 0.4455827474594116,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.48051048211144215,
      "eval_loss": 2.09228515625,
      "eval_runtime": 0.4979,
      "eval_samples_per_second": 2253.378,
      "eval_steps_per_second": 6.025,
      "step": 110
    },
    {
      "epoch": 24.0,
      "grad_norm": 442.5467224121094,
      "learning_rate": 1.609827544223212e-05,
      "loss": 5.9045,
      "step": 120
    },
    {
      "epoch": 24.0,
      "eval_brier_0th_event": 0.6661456823348999,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.3677755892276764,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.5158321558527434,
      "eval_ipcw_0th_event": 0.4977925609560049,
      "eval_ipcw_0th_event_0.25": 0.5031395554542542,
      "eval_ipcw_0th_event_0.50": 0.5104884505271912,
      "eval_ipcw_0th_event_0.75": 0.49652135372161865,
      "eval_ipcw_0th_event_1.00": 0.49111315608024597,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.464470586678595,
      "eval_ipcw_1th_event_0.25": 0.4873669445514679,
      "eval_ipcw_1th_event_0.50": 0.4805559515953064,
      "eval_ipcw_1th_event_0.75": 0.4736034572124481,
      "eval_ipcw_1th_event_1.00": 0.44413629174232483,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.4811315738172999,
      "eval_loss": 2.035587787628174,
      "eval_runtime": 0.4623,
      "eval_samples_per_second": 2426.928,
      "eval_steps_per_second": 6.489,
      "step": 120
    },
    {
      "epoch": 26.0,
      "grad_norm": 527.8936767578125,
      "learning_rate": 1.6024696419039296e-05,
      "loss": 5.651,
      "step": 130
    },
    {
      "epoch": 26.0,
      "eval_brier_0th_event": 0.6676298975944519,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.3597283363342285,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.5125145876101034,
      "eval_ipcw_0th_event": 0.49911828724186075,
      "eval_ipcw_0th_event_0.25": 0.5026523470878601,
      "eval_ipcw_0th_event_0.50": 0.5132458806037903,
      "eval_ipcw_0th_event_0.75": 0.4979223608970642,
      "eval_ipcw_0th_event_1.00": 0.4921209216117859,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.46473151109842065,
      "eval_ipcw_1th_event_0.25": 0.48690471053123474,
      "eval_ipcw_1th_event_0.50": 0.4816565215587616,
      "eval_ipcw_1th_event_0.75": 0.47439900040626526,
      "eval_ipcw_1th_event_1.00": 0.44376522302627563,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.48192489917014064,
      "eval_loss": 2.0569233894348145,
      "eval_runtime": 0.4866,
      "eval_samples_per_second": 2305.653,
      "eval_steps_per_second": 6.165,
      "step": 130
    },
    {
      "epoch": 28.0,
      "grad_norm": 1633.22412109375,
      "learning_rate": 1.5942726359394362e-05,
      "loss": 5.9274,
      "step": 140
    },
    {
      "epoch": 28.0,
      "eval_brier_0th_event": 0.6692634224891663,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.3537953495979309,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.5103362390205106,
      "eval_ipcw_0th_event": 0.5017472306143181,
      "eval_ipcw_0th_event_0.25": 0.504992663860321,
      "eval_ipcw_0th_event_0.50": 0.5176176428794861,
      "eval_ipcw_0th_event_0.75": 0.5006368160247803,
      "eval_ipcw_0th_event_1.00": 0.49389925599098206,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.4655428884537399,
      "eval_ipcw_1th_event_0.25": 0.48657768964767456,
      "eval_ipcw_1th_event_0.50": 0.48192381858825684,
      "eval_ipcw_1th_event_0.75": 0.4768611490726471,
      "eval_ipcw_1th_event_1.00": 0.4439004361629486,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.48364505953402903,
      "eval_loss": 2.014061689376831,
      "eval_runtime": 0.468,
      "eval_samples_per_second": 2397.491,
      "eval_steps_per_second": 6.41,
      "step": 140
    },
    {
      "epoch": 30.0,
      "grad_norm": 409.8191833496094,
      "learning_rate": 1.5852453038890304e-05,
      "loss": 5.8934,
      "step": 150
    },
    {
      "epoch": 30.0,
      "eval_brier_0th_event": 0.6688618659973145,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.34949764609336853,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.5079718732166579,
      "eval_ipcw_0th_event": 0.5029751345905918,
      "eval_ipcw_0th_event_0.25": 0.5067566633224487,
      "eval_ipcw_0th_event_0.50": 0.5202094912528992,
      "eval_ipcw_0th_event_0.75": 0.5015618205070496,
      "eval_ipcw_0th_event_1.00": 0.49453607201576233,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.4671925686606484,
      "eval_ipcw_1th_event_0.25": 0.48747387528419495,
      "eval_ipcw_1th_event_0.50": 0.482052743434906,
      "eval_ipcw_1th_event_0.75": 0.4798327088356018,
      "eval_ipcw_1th_event_1.00": 0.4455041289329529,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.4850838516256202,
      "eval_loss": 1.9897887706756592,
      "eval_runtime": 0.4682,
      "eval_samples_per_second": 2396.165,
      "eval_steps_per_second": 6.407,
      "step": 150
    }
  ],
  "logging_steps": 10,
  "max_steps": 1000,
  "num_input_tokens_seen": 0,
  "num_train_epochs": 200,
  "save_steps": 10,
  "stateful_callbacks": {
    "EarlyStoppingCallback": {
      "args": {
        "early_stopping_patience": 10,
        "early_stopping_threshold": 0.0
      },
      "attributes": {
        "early_stopping_patience_counter": 0
      }
    },
    "TrainerControl": {
      "args": {
        "should_epoch_stop": false,
        "should_evaluate": false,
        "should_log": false,
        "should_save": true,
        "should_training_stop": false
      },
      "attributes": {}
    }
  },
  "total_flos": 85960974600.0,
  "train_batch_size": 256,
  "trial_name": null,
  "trial_params": null
}
