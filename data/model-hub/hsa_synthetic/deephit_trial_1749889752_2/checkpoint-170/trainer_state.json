{
  "best_global_step": 70,
  "best_metric": 0.5067385893376863,
  "best_model_checkpoint": "./data/model-hub/hsa_synthetic/deephit_trial_1749889752_2/checkpoint-70",
  "epoch": 34.0,
  "eval_steps": 10,
  "global_step": 170,
  "is_hyper_param_search": false,
  "is_local_process_zero": true,
  "is_world_process_zero": true,
  "log_history": [
    {
      "epoch": 2.0,
      "grad_norm": 17.329349517822266,
      "learning_rate": 2.1053511481076765e-05,
      "loss": 5.105,
      "step": 10
    },
    {
      "epoch": 4.0,
      "grad_norm": 17.20206069946289,
      "learning_rate": 4.210702296215353e-05,
      "loss": 4.9496,
      "step": 20
    },
    {
      "epoch": 6.0,
      "grad_norm": 14.204777717590332,
      "learning_rate": 6.31605344432303e-05,
      "loss": 5.2594,
      "step": 30
    },
    {
      "epoch": 8.0,
      "grad_norm": 11.07275390625,
      "learning_rate": 8.421404592430706e-05,
      "loss": 5.3148,
      "step": 40
    },
    {
      "epoch": 8.0,
      "eval_brier_0th_event": 0.4555586278438568,
      "eval_brier_0th_event_n": 355,
      "eval_brier_1th_event": 0.31470051407814026,
      "eval_brier_1th_event_n": 328,
      "eval_brier_weighted_avg": 0.38791373572796367,
      "eval_ipcw_0th_event": 0.5331333079687177,
      "eval_ipcw_0th_event_0.25": 0.47206875681877136,
      "eval_ipcw_0th_event_0.50": 0.5375022888183594,
      "eval_ipcw_0th_event_0.75": 0.5495349168777466,
      "eval_ipcw_0th_event_1.00": 0.5325398445129395,
      "eval_ipcw_0th_event_n": 1185,
      "eval_ipcw_1th_event": 0.4574611677385088,
      "eval_ipcw_1th_event_0.25": 0.4718066155910492,
      "eval_ipcw_1th_event_0.50": 0.4355483949184418,
      "eval_ipcw_1th_event_0.75": 0.4374843239784241,
      "eval_ipcw_1th_event_1.00": 0.48005372285842896,
      "eval_ipcw_1th_event_n": 1185,
      "eval_ipcw_weighted_avg": 0.49529723785361324,
      "eval_loss": 2.9181370735168457,
      "eval_runtime": 5.9712,
      "eval_samples_per_second": 198.453,
      "eval_steps_per_second": 0.502,
      "step": 40
    },
    {
      "epoch": 10.0,
      "grad_norm": 11.973977088928223,
      "learning_rate": 8.41780763531059e-05,
      "loss": 5.3062,
      "step": 50
    },
    {
      "epoch": 10.0,
      "eval_brier_0th_event": 0.44403743743896484,
      "eval_brier_0th_event_n": 355,
      "eval_brier_1th_event": 0.30560675263404846,
      "eval_brier_1th_event_n": 328,
      "eval_brier_weighted_avg": 0.3775582798752568,
      "eval_ipcw_0th_event": 0.5397451382286838,
      "eval_ipcw_0th_event_0.25": 0.4543183743953705,
      "eval_ipcw_0th_event_0.50": 0.5305089950561523,
      "eval_ipcw_0th_event_0.75": 0.5619802474975586,
      "eval_ipcw_0th_event_1.00": 0.5471446514129639,
      "eval_ipcw_0th_event_n": 1185,
      "eval_ipcw_1th_event": 0.4479918447670652,
      "eval_ipcw_1th_event_0.25": 0.4713495373725891,
      "eval_ipcw_1th_event_0.50": 0.43846869468688965,
      "eval_ipcw_1th_event_0.75": 0.4353586733341217,
      "eval_ipcw_1th_event_1.00": 0.4571557343006134,
      "eval_ipcw_1th_event_n": 1185,
      "eval_ipcw_weighted_avg": 0.4938684914978745,
      "eval_loss": 2.9157536029815674,
      "eval_runtime": 0.5303,
      "eval_samples_per_second": 2234.445,
      "eval_steps_per_second": 5.657,
      "step": 50
    },
    {
      "epoch": 12.0,
      "grad_norm": 11.185301780700684,
      "learning_rate": 8.407022909291151e-05,
      "loss": 5.3061,
      "step": 60
    },
    {
      "epoch": 12.0,
      "eval_brier_0th_event": 0.4253769814968109,
      "eval_brier_0th_event_n": 355,
      "eval_brier_1th_event": 0.30526742339134216,
      "eval_brier_1th_event_n": 328,
      "eval_brier_weighted_avg": 0.36769625666724465,
      "eval_ipcw_0th_event": 0.5451375973684699,
      "eval_ipcw_0th_event_0.25": 0.4651243984699249,
      "eval_ipcw_0th_event_0.50": 0.5434633493423462,
      "eval_ipcw_0th_event_0.75": 0.561595618724823,
      "eval_ipcw_0th_event_1.00": 0.5518553256988525,
      "eval_ipcw_0th_event_n": 1185,
      "eval_ipcw_1th_event": 0.44741743862332395,
      "eval_ipcw_1th_event_0.25": 0.4827544391155243,
      "eval_ipcw_1th_event_0.50": 0.46134576201438904,
      "eval_ipcw_1th_event_0.75": 0.44974514842033386,
      "eval_ipcw_1th_event_1.00": 0.4314420223236084,
      "eval_ipcw_1th_event_n": 1185,
      "eval_ipcw_weighted_avg": 0.49627751799589687,
      "eval_loss": 2.907313823699951,
      "eval_runtime": 0.5234,
      "eval_samples_per_second": 2263.918,
      "eval_steps_per_second": 5.731,
      "step": 60
    },
    {
      "epoch": 14.0,
      "grad_norm": 6.298227787017822,
      "learning_rate": 8.389068839895878e-05,
      "loss": 5.3041,
      "step": 70
    },
    {
      "epoch": 14.0,
      "eval_brier_0th_event": 0.3979479670524597,
      "eval_brier_0th_event_n": 355,
      "eval_brier_1th_event": 0.3029195964336395,
      "eval_brier_1th_event_n": 328,
      "eval_brier_weighted_avg": 0.3523120877508887,
      "eval_ipcw_0th_event": 0.5459449404890773,
      "eval_ipcw_0th_event_0.25": 0.4595829248428345,
      "eval_ipcw_0th_event_0.50": 0.5368924736976624,
      "eval_ipcw_0th_event_0.75": 0.5633215308189392,
      "eval_ipcw_0th_event_1.00": 0.5571199059486389,
      "eval_ipcw_0th_event_n": 1185,
      "eval_ipcw_1th_event": 0.46753223818629536,
      "eval_ipcw_1th_event_0.25": 0.5020016431808472,
      "eval_ipcw_1th_event_0.50": 0.48581966757774353,
      "eval_ipcw_1th_event_0.75": 0.4741966426372528,
      "eval_ipcw_1th_event_1.00": 0.44636327028274536,
      "eval_ipcw_1th_event_n": 1185,
      "eval_ipcw_weighted_avg": 0.5067385893376863,
      "eval_loss": 2.8969473838806152,
      "eval_runtime": 0.5387,
      "eval_samples_per_second": 2199.781,
      "eval_steps_per_second": 5.569,
      "step": 70
    },
    {
      "epoch": 16.0,
      "grad_norm": 5.927701473236084,
      "learning_rate": 8.363976101351164e-05,
      "loss": 5.3113,
      "step": 80
    },
    {
      "epoch": 16.0,
      "eval_brier_0th_event": 0.3718878924846649,
      "eval_brier_0th_event_n": 355,
      "eval_brier_1th_event": 0.2855612635612488,
      "eval_brier_1th_event_n": 328,
      "eval_brier_weighted_avg": 0.3304308876722484,
      "eval_ipcw_0th_event": 0.509488127017806,
      "eval_ipcw_0th_event_0.25": 0.45190006494522095,
      "eval_ipcw_0th_event_0.50": 0.49347805976867676,
      "eval_ipcw_0th_event_0.75": 0.5265871286392212,
      "eval_ipcw_0th_event_1.00": 0.5177951455116272,
      "eval_ipcw_0th_event_n": 1185,
      "eval_ipcw_1th_event": 0.4777293113704345,
      "eval_ipcw_1th_event_0.25": 0.5182657837867737,
      "eval_ipcw_1th_event_0.50": 0.49799537658691406,
      "eval_ipcw_1th_event_0.75": 0.4824153482913971,
      "eval_ipcw_1th_event_1.00": 0.45582032203674316,
      "eval_ipcw_1th_event_n": 1185,
      "eval_ipcw_weighted_avg": 0.4936087191941203,
      "eval_loss": 2.8881733417510986,
      "eval_runtime": 0.5471,
      "eval_samples_per_second": 2165.868,
      "eval_steps_per_second": 5.483,
      "step": 80
    },
    {
      "epoch": 18.0,
      "grad_norm": 4.946522235870361,
      "learning_rate": 8.331787564179891e-05,
      "loss": 5.3085,
      "step": 90
    },
    {
      "epoch": 18.0,
      "eval_brier_0th_event": 0.3480657637119293,
      "eval_brier_0th_event_n": 355,
      "eval_brier_1th_event": 0.2588280141353607,
      "eval_brier_1th_event_n": 328,
      "eval_brier_weighted_avg": 0.3052107390250853,
      "eval_ipcw_0th_event": 0.4660888671469066,
      "eval_ipcw_0th_event_0.25": 0.473584920167923,
      "eval_ipcw_0th_event_0.50": 0.49666279554367065,
      "eval_ipcw_0th_event_0.75": 0.47013580799102783,
      "eval_ipcw_0th_event_1.00": 0.446004718542099,
      "eval_ipcw_0th_event_n": 1185,
      "eval_ipcw_1th_event": 0.4831133022607855,
      "eval_ipcw_1th_event_0.25": 0.533623218536377,
      "eval_ipcw_1th_event_0.50": 0.5013055801391602,
      "eval_ipcw_1th_event_0.75": 0.48092010617256165,
      "eval_ipcw_1th_event_1.00": 0.4652908146381378,
      "eval_ipcw_1th_event_n": 1185,
      "eval_ipcw_weighted_avg": 0.47460108470384604,
      "eval_loss": 2.8897130489349365,
      "eval_runtime": 0.5502,
      "eval_samples_per_second": 2153.699,
      "eval_steps_per_second": 5.452,
      "step": 90
    },
    {
      "epoch": 20.0,
      "grad_norm": 4.775269508361816,
      "learning_rate": 8.292558221957866e-05,
      "loss": 5.311,
      "step": 100
    },
    {
      "epoch": 20.0,
      "eval_brier_0th_event": 0.323554128408432,
      "eval_brier_0th_event_n": 355,
      "eval_brier_1th_event": 0.23218154907226562,
      "eval_brier_1th_event_n": 328,
      "eval_brier_weighted_avg": 0.27967388533044873,
      "eval_ipcw_0th_event": 0.4580898723320847,
      "eval_ipcw_0th_event_0.25": 0.49357175827026367,
      "eval_ipcw_0th_event_0.50": 0.5071191787719727,
      "eval_ipcw_0th_event_0.75": 0.4501335620880127,
      "eval_ipcw_0th_event_1.00": 0.4313943386077881,
      "eval_ipcw_0th_event_n": 1185,
      "eval_ipcw_1th_event": 0.4819783803019951,
      "eval_ipcw_1th_event_0.25": 0.5347570180892944,
      "eval_ipcw_1th_event_0.50": 0.49376052618026733,
      "eval_ipcw_1th_event_0.75": 0.47363051772117615,
      "eval_ipcw_1th_event_1.00": 0.4714122712612152,
      "eval_ipcw_1th_event_n": 1185,
      "eval_ipcw_weighted_avg": 0.47003412631703995,
      "eval_loss": 2.8871383666992188,
      "eval_runtime": 0.5758,
      "eval_samples_per_second": 2057.853,
      "eval_steps_per_second": 5.21,
      "step": 100
    },
    {
      "epoch": 22.0,
      "grad_norm": 5.1545891761779785,
      "learning_rate": 8.246355097358217e-05,
      "loss": 5.313,
      "step": 110
    },
    {
      "epoch": 22.0,
      "eval_brier_0th_event": 0.3014434278011322,
      "eval_brier_0th_event_n": 355,
      "eval_brier_1th_event": 0.20937176048755646,
      "eval_brier_1th_event_n": 328,
      "eval_brier_weighted_avg": 0.25722745872521297,
      "eval_ipcw_0th_event": 0.46241896390644294,
      "eval_ipcw_0th_event_0.25": 0.5109920501708984,
      "eval_ipcw_0th_event_0.50": 0.5169657468795776,
      "eval_ipcw_0th_event_0.75": 0.448974072933197,
      "eval_ipcw_0th_event_1.00": 0.43409794569015503,
      "eval_ipcw_0th_event_n": 1185,
      "eval_ipcw_1th_event": 0.48262249289163905,
      "eval_ipcw_1th_event_0.25": 0.5280798673629761,
      "eval_ipcw_1th_event_0.50": 0.4916677474975586,
      "eval_ipcw_1th_event_0.75": 0.46983784437179565,
      "eval_ipcw_1th_event_1.00": 0.47829705476760864,
      "eval_ipcw_1th_event_n": 1185,
      "eval_ipcw_weighted_avg": 0.472520728399041,
      "eval_loss": 2.879838466644287,
      "eval_runtime": 0.5467,
      "eval_samples_per_second": 2167.706,
      "eval_steps_per_second": 5.488,
      "step": 110
    },
    {
      "epoch": 24.0,
      "grad_norm": 5.194847106933594,
      "learning_rate": 8.193257127644286e-05,
      "loss": 5.311,
      "step": 120
    },
    {
      "epoch": 24.0,
      "eval_brier_0th_event": 0.28035813570022583,
      "eval_brier_0th_event_n": 355,
      "eval_brier_1th_event": 0.18947984278202057,
      "eval_brier_1th_event_n": 328,
      "eval_brier_weighted_avg": 0.23671526589470412,
      "eval_ipcw_0th_event": 0.46403192939336135,
      "eval_ipcw_0th_event_0.25": 0.5189812183380127,
      "eval_ipcw_0th_event_0.50": 0.5151544809341431,
      "eval_ipcw_0th_event_0.75": 0.45044127106666565,
      "eval_ipcw_0th_event_1.00": 0.4360826313495636,
      "eval_ipcw_0th_event_n": 1185,
      "eval_ipcw_1th_event": 0.48471802732541197,
      "eval_ipcw_1th_event_0.25": 0.525643527507782,
      "eval_ipcw_1th_event_0.50": 0.492166668176651,
      "eval_ipcw_1th_event_0.75": 0.46802738308906555,
      "eval_ipcw_1th_event_1.00": 0.4850892126560211,
      "eval_ipcw_1th_event_n": 1185,
      "eval_ipcw_weighted_avg": 0.47437497835938663,
      "eval_loss": 2.872441053390503,
      "eval_runtime": 0.5497,
      "eval_samples_per_second": 2155.572,
      "eval_steps_per_second": 5.457,
      "step": 120
    },
    {
      "epoch": 26.0,
      "grad_norm": 4.532382965087891,
      "learning_rate": 8.133355029806633e-05,
      "loss": 5.3071,
      "step": 130
    },
    {
      "epoch": 26.0,
      "eval_brier_0th_event": 0.26070111989974976,
      "eval_brier_0th_event_n": 355,
      "eval_brier_1th_event": 0.17285287380218506,
      "eval_brier_1th_event_n": 328,
      "eval_brier_weighted_avg": 0.218513382388767,
      "eval_ipcw_0th_event": 0.4663342834872095,
      "eval_ipcw_0th_event_0.25": 0.5222792625427246,
      "eval_ipcw_0th_event_0.50": 0.5120410919189453,
      "eval_ipcw_0th_event_0.75": 0.4544120728969574,
      "eval_ipcw_0th_event_1.00": 0.43961843848228455,
      "eval_ipcw_0th_event_n": 1185,
      "eval_ipcw_1th_event": 0.4916077438575118,
      "eval_ipcw_1th_event_0.25": 0.5309911966323853,
      "eval_ipcw_1th_event_0.50": 0.5004526376724243,
      "eval_ipcw_1th_event_0.75": 0.4719679355621338,
      "eval_ipcw_1th_event_1.00": 0.4938785433769226,
      "eval_ipcw_1th_event_n": 1185,
      "eval_ipcw_weighted_avg": 0.47897101367236067,
      "eval_loss": 2.862942934036255,
      "eval_runtime": 0.5478,
      "eval_samples_per_second": 2163.376,
      "eval_steps_per_second": 5.477,
      "step": 130
    },
    {
      "epoch": 28.0,
      "grad_norm": 4.990993976593018,
      "learning_rate": 8.066751145574576e-05,
      "loss": 5.3015,
      "step": 140
    },
    {
      "epoch": 28.0,
      "eval_brier_0th_event": 0.2417900413274765,
      "eval_brier_0th_event_n": 355,
      "eval_brier_1th_event": 0.1594928354024887,
      "eval_brier_1th_event_n": 328,
      "eval_brier_weighted_avg": 0.202268103489415,
      "eval_ipcw_0th_event": 0.46818604165525357,
      "eval_ipcw_0th_event_0.25": 0.5240471363067627,
      "eval_ipcw_0th_event_0.50": 0.5092479586601257,
      "eval_ipcw_0th_event_0.75": 0.45774927735328674,
      "eval_ipcw_0th_event_1.00": 0.4427011013031006,
      "eval_ipcw_0th_event_n": 1185,
      "eval_ipcw_1th_event": 0.49600642378353954,
      "eval_ipcw_1th_event_0.25": 0.5334932804107666,
      "eval_ipcw_1th_event_0.50": 0.5069908499717712,
      "eval_ipcw_1th_event_0.75": 0.4736454486846924,
      "eval_ipcw_1th_event_1.00": 0.4997236430644989,
      "eval_ipcw_1th_event_n": 1185,
      "eval_ipcw_weighted_avg": 0.48209623271939656,
      "eval_loss": 2.8568124771118164,
      "eval_runtime": 0.5755,
      "eval_samples_per_second": 2059.15,
      "eval_steps_per_second": 5.213,
      "step": 140
    },
    {
      "epoch": 30.0,
      "grad_norm": 5.470676422119141,
      "learning_rate": 7.993559266567074e-05,
      "loss": 5.3066,
      "step": 150
    },
    {
      "epoch": 30.0,
      "eval_brier_0th_event": 0.2240641862154007,
      "eval_brier_0th_event_n": 355,
      "eval_brier_1th_event": 0.14905880391597748,
      "eval_brier_1th_event_n": 328,
      "eval_brier_weighted_avg": 0.1880440319046967,
      "eval_ipcw_0th_event": 0.47014093923379296,
      "eval_ipcw_0th_event_0.25": 0.5233436226844788,
      "eval_ipcw_0th_event_0.50": 0.5062631964683533,
      "eval_ipcw_0th_event_0.75": 0.4613410234451294,
      "eval_ipcw_0th_event_1.00": 0.4465082585811615,
      "eval_ipcw_0th_event_n": 1185,
      "eval_ipcw_1th_event": 0.49880702215344164,
      "eval_ipcw_1th_event_0.25": 0.5320831537246704,
      "eval_ipcw_1th_event_0.50": 0.510154664516449,
      "eval_ipcw_1th_event_0.75": 0.474517822265625,
      "eval_ipcw_1th_event_1.00": 0.5047128200531006,
      "eval_ipcw_1th_event_n": 1185,
      "eval_ipcw_weighted_avg": 0.48447398069361736,
      "eval_loss": 2.842965841293335,
      "eval_runtime": 0.5505,
      "eval_samples_per_second": 2152.67,
      "eval_steps_per_second": 5.45,
      "step": 150
    },
    {
      "epoch": 32.0,
      "grad_norm": 5.71945858001709,
      "learning_rate": 7.913904439881645e-05,
      "loss": 5.297,
      "step": 160
    },
    {
      "epoch": 32.0,
      "eval_brier_0th_event": 0.20728188753128052,
      "eval_brier_0th_event_n": 355,
      "eval_brier_1th_event": 0.14046381413936615,
      "eval_brier_1th_event_n": 328,
      "eval_brier_weighted_avg": 0.17519355946020013,
      "eval_ipcw_0th_event": 0.47217976911655213,
      "eval_ipcw_0th_event_0.25": 0.5203323364257812,
      "eval_ipcw_0th_event_0.50": 0.5043512582778931,
      "eval_ipcw_0th_event_0.75": 0.4649677574634552,
      "eval_ipcw_0th_event_1.00": 0.45048603415489197,
      "eval_ipcw_0th_event_n": 1185,
      "eval_ipcw_1th_event": 0.5014885860073626,
      "eval_ipcw_1th_event_0.25": 0.5319471955299377,
      "eval_ipcw_1th_event_0.50": 0.5132721066474915,
      "eval_ipcw_1th_event_0.75": 0.47489723563194275,
      "eval_ipcw_1th_event_1.00": 0.5095347166061401,
      "eval_ipcw_1th_event_n": 1185,
      "eval_ipcw_weighted_avg": 0.4868341775619574,
      "eval_loss": 2.8370509147644043,
      "eval_runtime": 0.5434,
      "eval_samples_per_second": 2180.662,
      "eval_steps_per_second": 5.521,
      "step": 160
    },
    {
      "epoch": 34.0,
      "grad_norm": 5.921749114990234,
      "learning_rate": 7.827922754453508e-05,
      "loss": 5.3027,
      "step": 170
    },
    {
      "epoch": 34.0,
      "eval_brier_0th_event": 0.1918971836566925,
      "eval_brier_0th_event_n": 355,
      "eval_brier_1th_event": 0.1335282027721405,
      "eval_brier_1th_event_n": 328,
      "eval_brier_weighted_avg": 0.16386639927875246,
      "eval_ipcw_0th_event": 0.4745662446798721,
      "eval_ipcw_0th_event_0.25": 0.5174846649169922,
      "eval_ipcw_0th_event_0.50": 0.5038295388221741,
      "eval_ipcw_0th_event_0.75": 0.46777206659317017,
      "eval_ipcw_0th_event_1.00": 0.45521071553230286,
      "eval_ipcw_0th_event_n": 1185,
      "eval_ipcw_1th_event": 0.5047933344743145,
      "eval_ipcw_1th_event_0.25": 0.5350422859191895,
      "eval_ipcw_1th_event_0.50": 0.5184943675994873,
      "eval_ipcw_1th_event_0.75": 0.4761415421962738,
      "eval_ipcw_1th_event_1.00": 0.5135305523872375,
      "eval_ipcw_1th_event_n": 1185,
      "eval_ipcw_weighted_avg": 0.4896797895770933,
      "eval_loss": 2.8252274990081787,
      "eval_runtime": 0.5383,
      "eval_samples_per_second": 2201.453,
      "eval_steps_per_second": 5.573,
      "step": 170
    }
  ],
  "logging_steps": 10,
  "max_steps": 800,
  "num_input_tokens_seen": 0,
  "num_train_epochs": 200,
  "save_steps": 10,
  "stateful_callbacks": {
    "EarlyStoppingCallback": {
      "args": {
        "early_stopping_patience": 10,
        "early_stopping_threshold": 0.0
      },
      "attributes": {
        "early_stopping_patience_counter": 10
      }
    },
    "TrainerControl": {
      "args": {
        "should_epoch_stop": false,
        "should_evaluate": false,
        "should_log": false,
        "should_save": true,
        "should_training_stop": true
      },
      "attributes": {}
    }
  },
  "total_flos": 28786974480.0,
  "train_batch_size": 256,
  "trial_name": null,
  "trial_params": null
}
