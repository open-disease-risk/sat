{
  "best_global_step": 40,
  "best_metric": 0.5347696474222605,
  "best_model_checkpoint": "./data/model-hub/hsa_synthetic/deephit_trial_1749857914_1/checkpoint-40",
  "epoch": 28.0,
  "eval_steps": 10,
  "global_step": 140,
  "is_hyper_param_search": false,
  "is_local_process_zero": true,
  "is_world_process_zero": true,
  "log_history": [
    {
      "epoch": 2.0,
      "grad_norm": 86.01731872558594,
      "learning_rate": 8.749303544837661e-06,
      "loss": 5.6538,
      "step": 10
    },
    {
      "epoch": 4.0,
      "grad_norm": 519.4961547851562,
      "learning_rate": 1.7498607089675322e-05,
      "loss": 5.6924,
      "step": 20
    },
    {
      "epoch": 6.0,
      "grad_norm": 69.53855895996094,
      "learning_rate": 2.624791063451298e-05,
      "loss": 5.691,
      "step": 30
    },
    {
      "epoch": 8.0,
      "grad_norm": 40.15239334106445,
      "learning_rate": 3.4997214179350644e-05,
      "loss": 5.8018,
      "step": 40
    },
    {
      "epoch": 8.0,
      "eval_brier_0th_event": 0.5027986168861389,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.4336606562137604,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.4681798970098976,
      "eval_ipcw_0th_event": 0.5518886015308855,
      "eval_ipcw_0th_event_0.25": 0.42021486163139343,
      "eval_ipcw_0th_event_0.50": 0.5397812128067017,
      "eval_ipcw_0th_event_0.75": 0.583143949508667,
      "eval_ipcw_0th_event_1.00": 0.566211998462677,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.5176506933136358,
      "eval_ipcw_1th_event_0.25": 0.5030154585838318,
      "eval_ipcw_1th_event_0.50": 0.4888898432254791,
      "eval_ipcw_1th_event_0.75": 0.5299609899520874,
      "eval_ipcw_1th_event_1.00": 0.5266202092170715,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.5347696474222605,
      "eval_loss": 2.843686103820801,
      "eval_runtime": 1.9075,
      "eval_samples_per_second": 617.049,
      "eval_steps_per_second": 1.573,
      "step": 40
    },
    {
      "epoch": 10.0,
      "grad_norm": 41.108970642089844,
      "learning_rate": 3.498784520596867e-05,
      "loss": 5.9043,
      "step": 50
    },
    {
      "epoch": 10.0,
      "eval_brier_0th_event": 0.48972320556640625,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.3942221403121948,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.4419039671369594,
      "eval_ipcw_0th_event": 0.542037124994775,
      "eval_ipcw_0th_event_0.25": 0.4284667670726776,
      "eval_ipcw_0th_event_0.50": 0.5350863933563232,
      "eval_ipcw_0th_event_0.75": 0.5677836537361145,
      "eval_ipcw_0th_event_1.00": 0.553651750087738,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.5245370384890325,
      "eval_ipcw_1th_event_0.25": 0.5117665529251099,
      "eval_ipcw_1th_event_0.50": 0.4916444420814514,
      "eval_ipcw_1th_event_0.75": 0.5343881845474243,
      "eval_ipcw_1th_event_1.00": 0.5369048714637756,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.5332870817419038,
      "eval_loss": 2.8222734928131104,
      "eval_runtime": 0.4928,
      "eval_samples_per_second": 2388.344,
      "eval_steps_per_second": 6.088,
      "step": 50
    },
    {
      "epoch": 12.0,
      "grad_norm": 74.83500671386719,
      "learning_rate": 3.495974831835413e-05,
      "loss": 5.9244,
      "step": 60
    },
    {
      "epoch": 12.0,
      "eval_brier_0th_event": 0.4709959626197815,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.36848562955856323,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.4196670476481211,
      "eval_ipcw_0th_event": 0.5198982295715753,
      "eval_ipcw_0th_event_0.25": 0.43991512060165405,
      "eval_ipcw_0th_event_0.50": 0.5166000723838806,
      "eval_ipcw_0th_event_0.75": 0.5367270112037659,
      "eval_ipcw_0th_event_1.00": 0.528296947479248,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.530600626102701,
      "eval_ipcw_1th_event_0.25": 0.5105053186416626,
      "eval_ipcw_1th_event_0.50": 0.47568434476852417,
      "eval_ipcw_1th_event_0.75": 0.5504041910171509,
      "eval_ipcw_1th_event_1.00": 0.5484177470207214,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.5252494278371381,
      "eval_loss": 2.804729700088501,
      "eval_runtime": 0.4863,
      "eval_samples_per_second": 2420.072,
      "eval_steps_per_second": 6.168,
      "step": 60
    },
    {
      "epoch": 14.0,
      "grad_norm": 99.43338012695312,
      "learning_rate": 3.491295360335802e-05,
      "loss": 5.9142,
      "step": 70
    },
    {
      "epoch": 14.0,
      "eval_brier_0th_event": 0.4531278908252716,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.3564951419830322,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.40474199644095604,
      "eval_ipcw_0th_event": 0.4885003838180936,
      "eval_ipcw_0th_event_0.25": 0.4450969994068146,
      "eval_ipcw_0th_event_0.50": 0.4856626093387604,
      "eval_ipcw_0th_event_0.75": 0.4979485273361206,
      "eval_ipcw_0th_event_1.00": 0.4933154284954071,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.5274632755765118,
      "eval_ipcw_1th_event_0.25": 0.4981640577316284,
      "eval_ipcw_1th_event_0.50": 0.47159114480018616,
      "eval_ipcw_1th_event_0.75": 0.5469086170196533,
      "eval_ipcw_1th_event_1.00": 0.5484564304351807,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.5079818296973028,
      "eval_loss": 2.8234896659851074,
      "eval_runtime": 0.4738,
      "eval_samples_per_second": 2484.37,
      "eval_steps_per_second": 6.332,
      "step": 70
    },
    {
      "epoch": 16.0,
      "grad_norm": 45.65179443359375,
      "learning_rate": 3.4847511169933245e-05,
      "loss": 5.9053,
      "step": 80
    },
    {
      "epoch": 16.0,
      "eval_brier_0th_event": 0.43887636065483093,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.35039055347442627,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.394569798210542,
      "eval_ipcw_0th_event": 0.4755118291982463,
      "eval_ipcw_0th_event_0.25": 0.44605663418769836,
      "eval_ipcw_0th_event_0.50": 0.4744584560394287,
      "eval_ipcw_0th_event_0.75": 0.48124071955680847,
      "eval_ipcw_0th_event_1.00": 0.4788774847984314,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.5267898303809717,
      "eval_ipcw_1th_event_0.25": 0.49361366033554077,
      "eval_ipcw_1th_event_0.50": 0.47542494535446167,
      "eval_ipcw_1th_event_0.75": 0.5442801117897034,
      "eval_ipcw_1th_event_1.00": 0.5480279326438904,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.501150829789609,
      "eval_loss": 2.7716100215911865,
      "eval_runtime": 0.4989,
      "eval_samples_per_second": 2359.047,
      "eval_steps_per_second": 6.013,
      "step": 80
    },
    {
      "epoch": 18.0,
      "grad_norm": 42.47467803955078,
      "learning_rate": 3.476349109547667e-05,
      "loss": 5.8973,
      "step": 90
    },
    {
      "epoch": 18.0,
      "eval_brier_0th_event": 0.4198048412799835,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.3448937237262726,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.38229538961280163,
      "eval_ipcw_0th_event": 0.47740355291416947,
      "eval_ipcw_0th_event_0.25": 0.44681230187416077,
      "eval_ipcw_0th_event_0.50": 0.47425734996795654,
      "eval_ipcw_0th_event_0.75": 0.4842676520347595,
      "eval_ipcw_0th_event_1.00": 0.481183260679245,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.5263549808033008,
      "eval_ipcw_1th_event_0.25": 0.49619054794311523,
      "eval_ipcw_1th_event_0.50": 0.48310545086860657,
      "eval_ipcw_1th_event_0.75": 0.5400837063789368,
      "eval_ipcw_1th_event_1.00": 0.5455728769302368,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.5018792668587352,
      "eval_loss": 2.826958417892456,
      "eval_runtime": 0.4955,
      "eval_samples_per_second": 2375.192,
      "eval_steps_per_second": 6.054,
      "step": 90
    },
    {
      "epoch": 20.0,
      "grad_norm": 71.01332092285156,
      "learning_rate": 3.466098335078849e-05,
      "loss": 6.0251,
      "step": 100
    },
    {
      "epoch": 20.0,
      "eval_brier_0th_event": 0.3999395966529846,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.33950039744377136,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.36967651561009796,
      "eval_ipcw_0th_event": 0.49286818430877066,
      "eval_ipcw_0th_event_0.25": 0.450093537569046,
      "eval_ipcw_0th_event_0.50": 0.4834875762462616,
      "eval_ipcw_0th_event_0.75": 0.5046963095664978,
      "eval_ipcw_0th_event_1.00": 0.49883490800857544,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.5291476702362401,
      "eval_ipcw_1th_event_0.25": 0.49865996837615967,
      "eval_ipcw_1th_event_0.50": 0.4834436774253845,
      "eval_ipcw_1th_event_0.75": 0.5432553887367249,
      "eval_ipcw_1th_event_1.00": 0.54938805103302,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.5110079272725053,
      "eval_loss": 2.749669313430786,
      "eval_runtime": 0.4871,
      "eval_samples_per_second": 2416.119,
      "eval_steps_per_second": 6.158,
      "step": 100
    },
    {
      "epoch": 22.0,
      "grad_norm": 44.390594482421875,
      "learning_rate": 3.454009770372926e-05,
      "loss": 5.8744,
      "step": 110
    },
    {
      "epoch": 22.0,
      "eval_brier_0th_event": 0.382066011428833,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.33419138193130493,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.35809425450057436,
      "eval_ipcw_0th_event": 0.5045380760246598,
      "eval_ipcw_0th_event_0.25": 0.4538201093673706,
      "eval_ipcw_0th_event_0.50": 0.49110162258148193,
      "eval_ipcw_0th_event_0.75": 0.5191888213157654,
      "eval_ipcw_0th_event_1.00": 0.5122342109680176,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.5327901321656379,
      "eval_ipcw_1th_event_0.25": 0.49524179100990295,
      "eval_ipcw_1th_event_0.50": 0.478772908449173,
      "eval_ipcw_1th_event_0.75": 0.5497032999992371,
      "eval_ipcw_1th_event_1.00": 0.5569338202476501,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.5186641040951488,
      "eval_loss": 2.841500759124756,
      "eval_runtime": 0.4961,
      "eval_samples_per_second": 2372.678,
      "eval_steps_per_second": 6.048,
      "step": 110
    },
    {
      "epoch": 24.0,
      "grad_norm": 49.92626953125,
      "learning_rate": 3.44009636016777e-05,
      "loss": 5.9086,
      "step": 120
    },
    {
      "epoch": 24.0,
      "eval_brier_0th_event": 0.3658313453197479,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.327382355928421,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.3465791894806375,
      "eval_ipcw_0th_event": 0.5201220631319592,
      "eval_ipcw_0th_event_0.25": 0.46217113733291626,
      "eval_ipcw_0th_event_0.50": 0.506210446357727,
      "eval_ipcw_0th_event_0.75": 0.5358334183692932,
      "eval_ipcw_0th_event_1.00": 0.5290037393569946,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.5319361553569021,
      "eval_ipcw_1th_event_0.25": 0.4930174648761749,
      "eval_ipcw_1th_event_0.50": 0.47249406576156616,
      "eval_ipcw_1th_event_0.75": 0.551112174987793,
      "eval_ipcw_1th_event_1.00": 0.5574483275413513,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.5260291092444307,
      "eval_loss": 2.7902722358703613,
      "eval_runtime": 0.4834,
      "eval_samples_per_second": 2434.847,
      "eval_steps_per_second": 6.206,
      "step": 120
    },
    {
      "epoch": 26.0,
      "grad_norm": 30.239675521850586,
      "learning_rate": 3.4243730032915234e-05,
      "loss": 5.8804,
      "step": 130
    },
    {
      "epoch": 26.0,
      "eval_brier_0th_event": 0.3510044515132904,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.31950852274894714,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.3352338281895617,
      "eval_ipcw_0th_event": 0.5289913583109637,
      "eval_ipcw_0th_event_0.25": 0.46641629934310913,
      "eval_ipcw_0th_event_0.50": 0.5111294388771057,
      "eval_ipcw_0th_event_0.75": 0.5445608496665955,
      "eval_ipcw_0th_event_1.00": 0.540953516960144,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.5339392527750131,
      "eval_ipcw_1th_event_0.25": 0.49451372027397156,
      "eval_ipcw_1th_event_0.50": 0.4732436239719391,
      "eval_ipcw_1th_event_0.75": 0.5532763004302979,
      "eval_ipcw_1th_event_1.00": 0.5600882768630981,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.5314653055429884,
      "eval_loss": 2.8758108615875244,
      "eval_runtime": 0.4783,
      "eval_samples_per_second": 2460.88,
      "eval_steps_per_second": 6.272,
      "step": 130
    },
    {
      "epoch": 28.0,
      "grad_norm": 13.749663352966309,
      "learning_rate": 3.406856536708555e-05,
      "loss": 5.8793,
      "step": 140
    },
    {
      "epoch": 28.0,
      "eval_brier_0th_event": 0.336076945066452,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.31032586097717285,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.32318287706203597,
      "eval_ipcw_0th_event": 0.5297054409840857,
      "eval_ipcw_0th_event_0.25": 0.464419424533844,
      "eval_ipcw_0th_event_0.50": 0.5095003247261047,
      "eval_ipcw_0th_event_0.75": 0.5443668961524963,
      "eval_ipcw_0th_event_1.00": 0.5440996885299683,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.5358892031278534,
      "eval_ipcw_1th_event_0.25": 0.49423855543136597,
      "eval_ipcw_1th_event_0.50": 0.4866812825202942,
      "eval_ipcw_1th_event_0.75": 0.5499957203865051,
      "eval_ipcw_1th_event_1.00": 0.5608235001564026,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.5327973220559695,
      "eval_loss": 2.8480024337768555,
      "eval_runtime": 0.4872,
      "eval_samples_per_second": 2415.785,
      "eval_steps_per_second": 6.157,
      "step": 140
    }
  ],
  "logging_steps": 10,
  "max_steps": 1000,
  "num_input_tokens_seen": 0,
  "num_train_epochs": 200,
  "save_steps": 10,
  "stateful_callbacks": {
    "EarlyStoppingCallback": {
      "args": {
        "early_stopping_patience": 10,
        "early_stopping_threshold": 0.0
      },
      "attributes": {
        "early_stopping_patience_counter": 10
      }
    },
    "TrainerControl": {
      "args": {
        "should_epoch_stop": false,
        "should_evaluate": false,
        "should_log": false,
        "should_save": true,
        "should_training_stop": true
      },
      "attributes": {}
    }
  },
  "total_flos": 89599819680.0,
  "train_batch_size": 256,
  "trial_name": null,
  "trial_params": null
}
