{
  "best_global_step": 70,
  "best_metric": 0.5034725127053138,
  "best_model_checkpoint": "./data/model-hub/hsa_synthetic/deephit_trial_1749889752_1/checkpoint-70",
  "epoch": 34.0,
  "eval_steps": 10,
  "global_step": 170,
  "is_hyper_param_search": false,
  "is_local_process_zero": true,
  "is_world_process_zero": true,
  "log_history": [
    {
      "epoch": 2.0,
      "grad_norm": 43.25697326660156,
      "learning_rate": 2.1053511481076765e-05,
      "loss": 5.553,
      "step": 10
    },
    {
      "epoch": 4.0,
      "grad_norm": 59.86054992675781,
      "learning_rate": 4.210702296215353e-05,
      "loss": 5.6379,
      "step": 20
    },
    {
      "epoch": 6.0,
      "grad_norm": 38.00908660888672,
      "learning_rate": 6.31605344432303e-05,
      "loss": 5.8466,
      "step": 30
    },
    {
      "epoch": 8.0,
      "grad_norm": 56.49510192871094,
      "learning_rate": 8.421404592430706e-05,
      "loss": 5.941,
      "step": 40
    },
    {
      "epoch": 8.0,
      "eval_brier_0th_event": 0.46028223633766174,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.31378865242004395,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.3869300533112862,
      "eval_ipcw_0th_event": 0.5282899239953134,
      "eval_ipcw_0th_event_0.25": 0.47975096106529236,
      "eval_ipcw_0th_event_0.50": 0.5146347880363464,
      "eval_ipcw_0th_event_0.75": 0.5455463528633118,
      "eval_ipcw_0th_event_1.00": 0.5336239337921143,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.4527268242112277,
      "eval_ipcw_1th_event_0.25": 0.4535830020904541,
      "eval_ipcw_1th_event_0.50": 0.41602030396461487,
      "eval_ipcw_1th_event_0.75": 0.4327227771282196,
      "eval_ipcw_1th_event_1.00": 0.4856938123703003,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.4905083741032705,
      "eval_loss": 2.9795758724212646,
      "eval_runtime": 4.8699,
      "eval_samples_per_second": 241.69,
      "eval_steps_per_second": 0.616,
      "step": 40
    },
    {
      "epoch": 10.0,
      "grad_norm": 39.90026092529297,
      "learning_rate": 8.419150129688017e-05,
      "loss": 5.8706,
      "step": 50
    },
    {
      "epoch": 10.0,
      "eval_brier_0th_event": 0.45307502150535583,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.3068837821483612,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.37987422827336426,
      "eval_ipcw_0th_event": 0.535304295275133,
      "eval_ipcw_0th_event_0.25": 0.4678126871585846,
      "eval_ipcw_0th_event_0.50": 0.508672833442688,
      "eval_ipcw_0th_event_0.75": 0.5579112768173218,
      "eval_ipcw_0th_event_1.00": 0.5473435521125793,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.44795035168887004,
      "eval_ipcw_1th_event_0.25": 0.4571244418621063,
      "eval_ipcw_1th_event_0.50": 0.43005847930908203,
      "eval_ipcw_1th_event_0.75": 0.4283199906349182,
      "eval_ipcw_1th_event_1.00": 0.4690859019756317,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.49162732348200155,
      "eval_loss": 2.9144163131713867,
      "eval_runtime": 0.5672,
      "eval_samples_per_second": 2075.223,
      "eval_steps_per_second": 5.289,
      "step": 50
    },
    {
      "epoch": 12.0,
      "grad_norm": 31.034500122070312,
      "learning_rate": 8.41238915559512e-05,
      "loss": 5.882,
      "step": 60
    },
    {
      "epoch": 12.0,
      "eval_brier_0th_event": 0.4399755895137787,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.3055858910083771,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.37268405702474305,
      "eval_ipcw_0th_event": 0.5399734238643601,
      "eval_ipcw_0th_event_0.25": 0.4788832366466522,
      "eval_ipcw_0th_event_0.50": 0.5282725095748901,
      "eval_ipcw_0th_event_0.75": 0.556583821773529,
      "eval_ipcw_0th_event_1.00": 0.5479081273078918,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.4534900906364533,
      "eval_ipcw_1th_event_0.25": 0.4726746380329132,
      "eval_ipcw_1th_event_0.50": 0.452801913022995,
      "eval_ipcw_1th_event_0.75": 0.4429013729095459,
      "eval_ipcw_1th_event_1.00": 0.4566715359687805,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.4967317572504067,
      "eval_loss": 2.941777467727661,
      "eval_runtime": 0.5447,
      "eval_samples_per_second": 2160.664,
      "eval_steps_per_second": 5.507,
      "step": 60
    },
    {
      "epoch": 14.0,
      "grad_norm": 30.30430030822754,
      "learning_rate": 8.401128909972421e-05,
      "loss": 5.896,
      "step": 70
    },
    {
      "epoch": 14.0,
      "eval_brier_0th_event": 0.4135661721229553,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.30370190739631653,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.35855500072026425,
      "eval_ipcw_0th_event": 0.5424313293376439,
      "eval_ipcw_0th_event_0.25": 0.48908892273902893,
      "eval_ipcw_0th_event_0.50": 0.5257742404937744,
      "eval_ipcw_0th_event_0.75": 0.5558167099952698,
      "eval_ipcw_0th_event_1.00": 0.5532164573669434,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.46451369607298376,
      "eval_ipcw_1th_event_0.25": 0.48482242226600647,
      "eval_ipcw_1th_event_0.50": 0.46865737438201904,
      "eval_ipcw_1th_event_0.75": 0.45818787813186646,
      "eval_ipcw_1th_event_1.00": 0.46181097626686096,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.5034725127053138,
      "eval_loss": 2.9483487606048584,
      "eval_runtime": 0.551,
      "eval_samples_per_second": 2136.163,
      "eval_steps_per_second": 5.445,
      "step": 70
    },
    {
      "epoch": 16.0,
      "grad_norm": 19.223169326782227,
      "learning_rate": 8.385381450572969e-05,
      "loss": 5.8263,
      "step": 80
    },
    {
      "epoch": 16.0,
      "eval_brier_0th_event": 0.3864041268825531,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.2910640835762024,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.33866551527016453,
      "eval_ipcw_0th_event": 0.5318341790370538,
      "eval_ipcw_0th_event_0.25": 0.47798535227775574,
      "eval_ipcw_0th_event_0.50": 0.5066543817520142,
      "eval_ipcw_0th_event_0.75": 0.5497053265571594,
      "eval_ipcw_0th_event_1.00": 0.5434101223945618,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.47503487791392396,
      "eval_ipcw_1th_event_0.25": 0.4993536174297333,
      "eval_ipcw_1th_event_0.50": 0.47979477047920227,
      "eval_ipcw_1th_event_0.75": 0.46501561999320984,
      "eval_ipcw_1th_event_1.00": 0.47372516989707947,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.5034345284754889,
      "eval_loss": 3.0376124382019043,
      "eval_runtime": 0.5674,
      "eval_samples_per_second": 2074.199,
      "eval_steps_per_second": 5.287,
      "step": 80
    },
    {
      "epoch": 18.0,
      "grad_norm": 15.11737060546875,
      "learning_rate": 8.36516364017072e-05,
      "loss": 5.9939,
      "step": 90
    },
    {
      "epoch": 18.0,
      "eval_brier_0th_event": 0.36198121309280396,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.2712608873844147,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.31655578381723637,
      "eval_ipcw_0th_event": 0.4891673699720924,
      "eval_ipcw_0th_event_0.25": 0.46870195865631104,
      "eval_ipcw_0th_event_0.50": 0.46145570278167725,
      "eval_ipcw_0th_event_0.75": 0.511069118976593,
      "eval_ipcw_0th_event_1.00": 0.49085453152656555,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.4808145793579425,
      "eval_ipcw_1th_event_0.25": 0.5108751058578491,
      "eval_ipcw_1th_event_0.50": 0.4852108359336853,
      "eval_ipcw_1th_event_0.75": 0.4644165337085724,
      "eval_ipcw_1th_event_1.00": 0.4829334616661072,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.4849909746650175,
      "eval_loss": 2.944917678833008,
      "eval_runtime": 0.554,
      "eval_samples_per_second": 2124.721,
      "eval_steps_per_second": 5.416,
      "step": 90
    },
    {
      "epoch": 20.0,
      "grad_norm": 21.591459274291992,
      "learning_rate": 8.340497128503454e-05,
      "loss": 5.8624,
      "step": 100
    },
    {
      "epoch": 20.0,
      "eval_brier_0th_event": 0.3382425308227539,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.24751539528369904,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.2928136917326948,
      "eval_ipcw_0th_event": 0.46724550342056115,
      "eval_ipcw_0th_event_0.25": 0.48741239309310913,
      "eval_ipcw_0th_event_0.50": 0.4764467477798462,
      "eval_ipcw_0th_event_0.75": 0.4800914227962494,
      "eval_ipcw_0th_event_1.00": 0.4484902620315552,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.4816997614854526,
      "eval_ipcw_1th_event_0.25": 0.5175781846046448,
      "eval_ipcw_1th_event_0.50": 0.4833318889141083,
      "eval_ipcw_1th_event_0.75": 0.4615902900695801,
      "eval_ipcw_1th_event_1.00": 0.4864276051521301,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.47447263245300686,
      "eval_loss": 3.0045597553253174,
      "eval_runtime": 0.757,
      "eval_samples_per_second": 1554.779,
      "eval_steps_per_second": 3.963,
      "step": 100
    },
    {
      "epoch": 22.0,
      "grad_norm": 16.88245391845703,
      "learning_rate": 8.311408329089693e-05,
      "loss": 5.9906,
      "step": 110
    },
    {
      "epoch": 22.0,
      "eval_brier_0th_event": 0.31513139605522156,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.22576765716075897,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.27038523614835397,
      "eval_ipcw_0th_event": 0.45990888851349343,
      "eval_ipcw_0th_event_0.25": 0.5050166249275208,
      "eval_ipcw_0th_event_0.50": 0.4800311028957367,
      "eval_ipcw_0th_event_0.75": 0.4636939465999603,
      "eval_ipcw_0th_event_1.00": 0.4367229640483856,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.4814937597765818,
      "eval_ipcw_1th_event_0.25": 0.515328049659729,
      "eval_ipcw_1th_event_0.50": 0.4810316264629364,
      "eval_ipcw_1th_event_0.75": 0.4600295126438141,
      "eval_ipcw_1th_event_1.00": 0.4888153076171875,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.47070132414503757,
      "eval_loss": 2.9207701683044434,
      "eval_runtime": 0.5545,
      "eval_samples_per_second": 2122.74,
      "eval_steps_per_second": 5.411,
      "step": 110
    },
    {
      "epoch": 24.0,
      "grad_norm": 26.343929290771484,
      "learning_rate": 8.277928390944444e-05,
      "loss": 5.9105,
      "step": 120
    },
    {
      "epoch": 24.0,
      "eval_brier_0th_event": 0.2930567264556885,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.2051198035478592,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.24902500102845884,
      "eval_ipcw_0th_event": 0.4633917678759691,
      "eval_ipcw_0th_event_0.25": 0.5233219861984253,
      "eval_ipcw_0th_event_0.50": 0.4903617799282074,
      "eval_ipcw_0th_event_0.75": 0.45971596240997314,
      "eval_ipcw_0th_event_1.00": 0.43894827365875244,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.4802991231350827,
      "eval_ipcw_1th_event_0.25": 0.508743941783905,
      "eval_ipcw_1th_event_0.50": 0.47769656777381897,
      "eval_ipcw_1th_event_0.75": 0.455782949924469,
      "eval_ipcw_1th_event_1.00": 0.4923897087574005,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.47184544550552593,
      "eval_loss": 2.919829845428467,
      "eval_runtime": 0.5608,
      "eval_samples_per_second": 2098.788,
      "eval_steps_per_second": 5.35,
      "step": 120
    },
    {
      "epoch": 26.0,
      "grad_norm": 10.058774948120117,
      "learning_rate": 8.240093165224055e-05,
      "loss": 5.9582,
      "step": 130
    },
    {
      "epoch": 26.0,
      "eval_brier_0th_event": 0.27408090233802795,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.18850325047969818,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.2312305097528499,
      "eval_ipcw_0th_event": 0.46711037185550297,
      "eval_ipcw_0th_event_0.25": 0.5326843857765198,
      "eval_ipcw_0th_event_0.50": 0.4945753514766693,
      "eval_ipcw_0th_event_0.75": 0.4616754949092865,
      "eval_ipcw_0th_event_1.00": 0.442376047372818,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.47900995881833297,
      "eval_ipcw_1th_event_0.25": 0.5046550035476685,
      "eval_ipcw_1th_event_0.50": 0.47511106729507446,
      "eval_ipcw_1th_event_0.75": 0.4523848295211792,
      "eval_ipcw_1th_event_1.00": 0.49406081438064575,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.47306016533691797,
      "eval_loss": 2.863093376159668,
      "eval_runtime": 0.5466,
      "eval_samples_per_second": 2153.366,
      "eval_steps_per_second": 5.489,
      "step": 130
    },
    {
      "epoch": 28.0,
      "grad_norm": 37.96746063232422,
      "learning_rate": 8.197943166835896e-05,
      "loss": 5.8478,
      "step": 140
    },
    {
      "epoch": 28.0,
      "eval_brier_0th_event": 0.25485488772392273,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.17436672747135162,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.21455290244637634,
      "eval_ipcw_0th_event": 0.46817574023920605,
      "eval_ipcw_0th_event_0.25": 0.536462664604187,
      "eval_ipcw_0th_event_0.50": 0.4931257963180542,
      "eval_ipcw_0th_event_0.75": 0.46252596378326416,
      "eval_ipcw_0th_event_1.00": 0.44412583112716675,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.4794309620595061,
      "eval_ipcw_1th_event_0.25": 0.5012741088867188,
      "eval_ipcw_1th_event_0.50": 0.4750508666038513,
      "eval_ipcw_1th_event_0.75": 0.4514360725879669,
      "eval_ipcw_1th_event_1.00": 0.49674952030181885,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.47380335114935607,
      "eval_loss": 2.9223990440368652,
      "eval_runtime": 0.5767,
      "eval_samples_per_second": 2040.909,
      "eval_steps_per_second": 5.202,
      "step": 140
    },
    {
      "epoch": 30.0,
      "grad_norm": 14.449679374694824,
      "learning_rate": 8.151523531053982e-05,
      "loss": 5.764,
      "step": 150
    },
    {
      "epoch": 30.0,
      "eval_brier_0th_event": 0.23591497540473938,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.16252048313617706,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.19916492747745926,
      "eval_ipcw_0th_event": 0.46960353784857783,
      "eval_ipcw_0th_event_0.25": 0.5348321199417114,
      "eval_ipcw_0th_event_0.50": 0.48919379711151123,
      "eval_ipcw_0th_event_0.75": 0.4655299186706543,
      "eval_ipcw_0th_event_1.00": 0.4476397931575775,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.4806658307096802,
      "eval_ipcw_1th_event_0.25": 0.4991486668586731,
      "eval_ipcw_1th_event_0.50": 0.4762304127216339,
      "eval_ipcw_1th_event_0.75": 0.4519892930984497,
      "eval_ipcw_1th_event_1.00": 0.4994095265865326,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.4751346842791291,
      "eval_loss": 2.963176965713501,
      "eval_runtime": 0.5842,
      "eval_samples_per_second": 2014.6,
      "eval_steps_per_second": 5.135,
      "step": 150
    },
    {
      "epoch": 32.0,
      "grad_norm": 13.153531074523926,
      "learning_rate": 8.100883965186995e-05,
      "loss": 5.9278,
      "step": 160
    },
    {
      "epoch": 32.0,
      "eval_brier_0th_event": 0.21808293461799622,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.15298667550086975,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.1854879732183415,
      "eval_ipcw_0th_event": 0.46957994763140387,
      "eval_ipcw_0th_event_0.25": 0.5323294997215271,
      "eval_ipcw_0th_event_0.50": 0.4854313135147095,
      "eval_ipcw_0th_event_0.75": 0.46610888838768005,
      "eval_ipcw_0th_event_1.00": 0.4495246112346649,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.4819220541747029,
      "eval_ipcw_1th_event_0.25": 0.4970189332962036,
      "eval_ipcw_1th_event_0.50": 0.47677645087242126,
      "eval_ipcw_1th_event_0.75": 0.452837735414505,
      "eval_ipcw_1th_event_1.00": 0.5022186040878296,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.4757510009030534,
      "eval_loss": 2.919127941131592,
      "eval_runtime": 0.5631,
      "eval_samples_per_second": 2090.095,
      "eval_steps_per_second": 5.327,
      "step": 160
    },
    {
      "epoch": 34.0,
      "grad_norm": 18.02328109741211,
      "learning_rate": 8.046078695350448e-05,
      "loss": 5.8488,
      "step": 170
    },
    {
      "epoch": 34.0,
      "eval_brier_0th_event": 0.20147067308425903,
      "eval_brier_0th_event_n": 347,
      "eval_brier_1th_event": 0.14529810845851898,
      "eval_brier_1th_event_n": 348,
      "eval_brier_weighted_avg": 0.17334397885439207,
      "eval_ipcw_0th_event": 0.47020753878802757,
      "eval_ipcw_0th_event_0.25": 0.5320106148719788,
      "eval_ipcw_0th_event_0.50": 0.4849716126918793,
      "eval_ipcw_0th_event_0.75": 0.46568506956100464,
      "eval_ipcw_0th_event_1.00": 0.45167380571365356,
      "eval_ipcw_0th_event_n": 1177,
      "eval_ipcw_1th_event": 0.48257800482665825,
      "eval_ipcw_1th_event_0.25": 0.4956975281238556,
      "eval_ipcw_1th_event_0.50": 0.47777682542800903,
      "eval_ipcw_1th_event_0.75": 0.45287784934043884,
      "eval_ipcw_1th_event_1.00": 0.5036861896514893,
      "eval_ipcw_1th_event_n": 1177,
      "eval_ipcw_weighted_avg": 0.4763927718073429,
      "eval_loss": 2.9680824279785156,
      "eval_runtime": 0.5797,
      "eval_samples_per_second": 2030.333,
      "eval_steps_per_second": 5.175,
      "step": 170
    }
  ],
  "logging_steps": 10,
  "max_steps": 1000,
  "num_input_tokens_seen": 0,
  "num_train_epochs": 200,
  "save_steps": 10,
  "stateful_callbacks": {
    "EarlyStoppingCallback": {
      "args": {
        "early_stopping_patience": 10,
        "early_stopping_threshold": 0.0
      },
      "attributes": {
        "early_stopping_patience_counter": 10
      }
    },
    "TrainerControl": {
      "args": {
        "should_epoch_stop": false,
        "should_evaluate": false,
        "should_log": false,
        "should_save": true,
        "should_training_stop": true
      },
      "attributes": {}
    }
  },
  "total_flos": 28887146640.0,
  "train_batch_size": 256,
  "trial_name": null,
  "trial_params": null
}
