{
  "best_global_step": 140,
  "best_metric": 0.8012000874350139,
  "best_model_checkpoint": "./data/model-hub/hsa_synthetic/deephit_trial_1749874034/checkpoint-140",
  "epoch": 28.0,
  "eval_steps": 10,
  "global_step": 140,
  "is_hyper_param_search": false,
  "is_local_process_zero": true,
  "is_world_process_zero": true,
  "log_history": [
    {
      "epoch": 2.0,
      "grad_norm": 17.420337677001953,
      "learning_rate": 0.0013179264064293013,
      "loss": 5.5525,
      "step": 10
    },
    {
      "epoch": 4.0,
      "grad_norm": 5.616223335266113,
      "learning_rate": 0.0026358528128586026,
      "loss": 4.3397,
      "step": 20
    },
    {
      "epoch": 6.0,
      "grad_norm": 3.3627102375030518,
      "learning_rate": 0.003953779219287904,
      "loss": 5.0194,
      "step": 30
    },
    {
      "epoch": 8.0,
      "grad_norm": 3.4805896282196045,
      "learning_rate": 0.005271705625717205,
      "loss": 5.7614,
      "step": 40
    },
    {
      "epoch": 8.0,
      "eval_brier_0th_event": 0.1150285080075264,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.11828551441431046,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.11666932969203335,
      "eval_ipcw_0th_event": 0.6496597008312239,
      "eval_ipcw_0th_event_0.25": 0.6356094479560852,
      "eval_ipcw_0th_event_0.50": 0.6484206914901733,
      "eval_ipcw_0th_event_0.75": 0.6520856022834778,
      "eval_ipcw_0th_event_1.00": 0.6519900560379028,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.691417800095699,
      "eval_ipcw_1th_event_0.25": 0.6946936249732971,
      "eval_ipcw_1th_event_0.50": 0.693314790725708,
      "eval_ipcw_1th_event_0.75": 0.6910303235054016,
      "eval_ipcw_1th_event_1.00": 0.6899642944335938,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.6705387504634615,
      "eval_loss": 2.9896278381347656,
      "eval_runtime": 2.2287,
      "eval_samples_per_second": 503.423,
      "eval_steps_per_second": 1.346,
      "step": 40
    },
    {
      "epoch": 10.0,
      "grad_norm": 2.8169667720794678,
      "learning_rate": 0.005270294357110744,
      "loss": 5.9528,
      "step": 50
    },
    {
      "epoch": 10.0,
      "eval_brier_0th_event": 0.1118144616484642,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.112217478454113,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.11201749432059893,
      "eval_ipcw_0th_event": 0.7100032387898954,
      "eval_ipcw_0th_event_0.25": 0.6957221627235413,
      "eval_ipcw_0th_event_0.50": 0.7091893553733826,
      "eval_ipcw_0th_event_0.75": 0.7123352289199829,
      "eval_ipcw_0th_event_1.00": 0.7122460603713989,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.695629180271458,
      "eval_ipcw_1th_event_0.25": 0.6984183192253113,
      "eval_ipcw_1th_event_0.50": 0.691791296005249,
      "eval_ipcw_1th_event_0.75": 0.6962658762931824,
      "eval_ipcw_1th_event_1.00": 0.6963602304458618,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.7028162095306767,
      "eval_loss": 2.9855940341949463,
      "eval_runtime": 0.4754,
      "eval_samples_per_second": 2360.221,
      "eval_steps_per_second": 6.311,
      "step": 50
    },
    {
      "epoch": 12.0,
      "grad_norm": 4.323683261871338,
      "learning_rate": 0.005266062062513132,
      "loss": 5.9675,
      "step": 60
    },
    {
      "epoch": 12.0,
      "eval_brier_0th_event": 0.11241242289543152,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.11497098952531815,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.11370138308870269,
      "eval_ipcw_0th_event": 0.7473481304190132,
      "eval_ipcw_0th_event_0.25": 0.7418741583824158,
      "eval_ipcw_0th_event_0.50": 0.7448545098304749,
      "eval_ipcw_0th_event_0.75": 0.7489588260650635,
      "eval_ipcw_0th_event_1.00": 0.7487804889678955,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.7195574146927702,
      "eval_ipcw_1th_event_0.25": 0.7215445637702942,
      "eval_ipcw_1th_event_0.50": 0.7148625254631042,
      "eval_ipcw_1th_event_0.75": 0.7208747863769531,
      "eval_ipcw_1th_event_1.00": 0.7204031348228455,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.7334527725558917,
      "eval_loss": 2.9532272815704346,
      "eval_runtime": 0.5214,
      "eval_samples_per_second": 2151.78,
      "eval_steps_per_second": 5.753,
      "step": 60
    },
    {
      "epoch": 14.0,
      "grad_norm": 8.627114295959473,
      "learning_rate": 0.005259013273971432,
      "loss": 5.9085,
      "step": 70
    },
    {
      "epoch": 14.0,
      "eval_brier_0th_event": 0.11021250486373901,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.10806585103273392,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.10913105898518426,
      "eval_ipcw_0th_event": 0.7517760186903784,
      "eval_ipcw_0th_event_0.25": 0.7572470307350159,
      "eval_ipcw_0th_event_0.50": 0.7593501210212708,
      "eval_ipcw_0th_event_0.75": 0.7485607862472534,
      "eval_ipcw_0th_event_1.00": 0.7489651441574097,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.7480649946676905,
      "eval_ipcw_1th_event_0.25": 0.7504614591598511,
      "eval_ipcw_1th_event_0.50": 0.7448328137397766,
      "eval_ipcw_1th_event_0.75": 0.7487791180610657,
      "eval_ipcw_1th_event_1.00": 0.748537003993988,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.7499205066790344,
      "eval_loss": 3.0007376670837402,
      "eval_runtime": 0.524,
      "eval_samples_per_second": 2141.389,
      "eval_steps_per_second": 5.726,
      "step": 70
    },
    {
      "epoch": 16.0,
      "grad_norm": 4.229390621185303,
      "learning_rate": 0.005249155539504969,
      "loss": 5.9381,
      "step": 80
    },
    {
      "epoch": 16.0,
      "eval_brier_0th_event": 0.10109826177358627,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.11412674188613892,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.10766177747325349,
      "eval_ipcw_0th_event": 0.7791619648350014,
      "eval_ipcw_0th_event_0.25": 0.7739635705947876,
      "eval_ipcw_0th_event_0.50": 0.7770489454269409,
      "eval_ipcw_0th_event_0.75": 0.7805705666542053,
      "eval_ipcw_0th_event_1.00": 0.7804814577102661,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.760368084936396,
      "eval_ipcw_1th_event_0.25": 0.7618838548660278,
      "eval_ipcw_1th_event_0.50": 0.7573196291923523,
      "eval_ipcw_1th_event_0.75": 0.7612974047660828,
      "eval_ipcw_1th_event_1.00": 0.7608068585395813,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.7697650248856988,
      "eval_loss": 3.0329318046569824,
      "eval_runtime": 0.5475,
      "eval_samples_per_second": 2049.177,
      "eval_steps_per_second": 5.479,
      "step": 80
    },
    {
      "epoch": 18.0,
      "grad_norm": 8.695664405822754,
      "learning_rate": 0.005236499415022715,
      "loss": 5.9633,
      "step": 90
    },
    {
      "epoch": 18.0,
      "eval_brier_0th_event": 0.10609503835439682,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.1056509017944336,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.10587129028409764,
      "eval_ipcw_0th_event": 0.7681778178977015,
      "eval_ipcw_0th_event_0.25": 0.7680029273033142,
      "eval_ipcw_0th_event_0.50": 0.7686110734939575,
      "eval_ipcw_0th_event_0.75": 0.7680698037147522,
      "eval_ipcw_0th_event_1.00": 0.7680825591087341,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.7927103922240093,
      "eval_ipcw_1th_event_0.25": 0.7939672470092773,
      "eval_ipcw_1th_event_0.50": 0.789991021156311,
      "eval_ipcw_1th_event_0.75": 0.7934280037879944,
      "eval_ipcw_1th_event_1.00": 0.7932078838348389,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.7804441050608554,
      "eval_loss": 3.02248215675354,
      "eval_runtime": 0.4632,
      "eval_samples_per_second": 2422.327,
      "eval_steps_per_second": 6.477,
      "step": 90
    },
    {
      "epoch": 20.0,
      "grad_norm": 4.308359622955322,
      "learning_rate": 0.005221058453019771,
      "loss": 5.9743,
      "step": 100
    },
    {
      "epoch": 20.0,
      "eval_brier_0th_event": 0.10017360001802444,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.10000278055667877,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.10008754422282307,
      "eval_ipcw_0th_event": 0.7875227628278078,
      "eval_ipcw_0th_event_0.25": 0.7868878841400146,
      "eval_ipcw_0th_event_0.50": 0.7879561185836792,
      "eval_ipcw_0th_event_0.75": 0.7875151038169861,
      "eval_ipcw_0th_event_1.00": 0.7874689698219299,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.8045323110810203,
      "eval_ipcw_1th_event_0.25": 0.8058487772941589,
      "eval_ipcw_1th_event_0.50": 0.8023583889007568,
      "eval_ipcw_1th_event_0.75": 0.8049635887145996,
      "eval_ipcw_1th_event_1.00": 0.8049588799476624,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.7960275369544141,
      "eval_loss": 3.006957769393921,
      "eval_runtime": 0.5092,
      "eval_samples_per_second": 2203.335,
      "eval_steps_per_second": 5.891,
      "step": 100
    },
    {
      "epoch": 22.0,
      "grad_norm": 6.156683444976807,
      "learning_rate": 0.005202849188065002,
      "loss": 5.9943,
      "step": 110
    },
    {
      "epoch": 22.0,
      "eval_brier_0th_event": 0.10563863813877106,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.10971033573150635,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.10768988669910518,
      "eval_ipcw_0th_event": 0.7867854324619421,
      "eval_ipcw_0th_event_0.25": 0.7839727997779846,
      "eval_ipcw_0th_event_0.50": 0.7859326004981995,
      "eval_ipcw_0th_event_0.75": 0.787529468536377,
      "eval_ipcw_0th_event_1.00": 0.787368655204773,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.8028025217264096,
      "eval_ipcw_1th_event_0.25": 0.8032026886940002,
      "eval_ipcw_1th_event_0.50": 0.8028583526611328,
      "eval_ipcw_1th_event_0.75": 0.8028583526611328,
      "eval_ipcw_1th_event_1.00": 0.8026350736618042,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.7947939770941759,
      "eval_loss": 3.0416419506073,
      "eval_runtime": 0.4997,
      "eval_samples_per_second": 2245.234,
      "eval_steps_per_second": 6.003,
      "step": 110
    },
    {
      "epoch": 24.0,
      "grad_norm": 10.250296592712402,
      "learning_rate": 0.005181891119095413,
      "loss": 5.9942,
      "step": 120
    },
    {
      "epoch": 24.0,
      "eval_brier_0th_event": 0.09838609397411346,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.09885971248149872,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.0986246945232198,
      "eval_ipcw_0th_event": 0.7889586934882603,
      "eval_ipcw_0th_event_0.25": 0.787384569644928,
      "eval_ipcw_0th_event_0.50": 0.7893459796905518,
      "eval_ipcw_0th_event_0.75": 0.7890530228614807,
      "eval_ipcw_0th_event_1.00": 0.7890849113464355,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.8098016757941997,
      "eval_ipcw_1th_event_0.25": 0.8105686902999878,
      "eval_ipcw_1th_event_0.50": 0.8074178695678711,
      "eval_ipcw_1th_event_0.75": 0.8104051947593689,
      "eval_ipcw_1th_event_1.00": 0.8103391528129578,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.7993801846412301,
      "eval_loss": 3.004459857940674,
      "eval_runtime": 0.477,
      "eval_samples_per_second": 2352.275,
      "eval_steps_per_second": 6.29,
      "step": 120
    },
    {
      "epoch": 26.0,
      "grad_norm": 4.686701774597168,
      "learning_rate": 0.0051582066885362005,
      "loss": 6.0081,
      "step": 130
    },
    {
      "epoch": 26.0,
      "eval_brier_0th_event": 0.1015874370932579,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.09693750739097595,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.09924488551858333,
      "eval_ipcw_0th_event": 0.788024120711804,
      "eval_ipcw_0th_event_0.25": 0.7868942022323608,
      "eval_ipcw_0th_event_0.50": 0.7880882620811462,
      "eval_ipcw_0th_event_0.75": 0.7881392240524292,
      "eval_ipcw_0th_event_1.00": 0.7881869673728943,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.8087553838696375,
      "eval_ipcw_1th_event_0.25": 0.810030996799469,
      "eval_ipcw_1th_event_0.50": 0.8055689334869385,
      "eval_ipcw_1th_event_0.75": 0.8095121383666992,
      "eval_ipcw_1th_event_1.00": 0.8094492554664612,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.7983897522907207,
      "eval_loss": 2.987356662750244,
      "eval_runtime": 0.4811,
      "eval_samples_per_second": 2332.335,
      "eval_steps_per_second": 6.236,
      "step": 130
    },
    {
      "epoch": 28.0,
      "grad_norm": 7.471211910247803,
      "learning_rate": 0.005131821258268838,
      "loss": 5.9433,
      "step": 140
    },
    {
      "epoch": 28.0,
      "eval_brier_0th_event": 0.10178335011005402,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.10123620927333832,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.10150771032393249,
      "eval_ipcw_0th_event": 0.7936084745975023,
      "eval_ipcw_0th_event_0.25": 0.7920047044754028,
      "eval_ipcw_0th_event_0.50": 0.7941667437553406,
      "eval_ipcw_0th_event_0.75": 0.7936126589775085,
      "eval_ipcw_0th_event_1.00": 0.7937209606170654,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.8087917002725256,
      "eval_ipcw_1th_event_0.25": 0.8092731237411499,
      "eval_ipcw_1th_event_0.50": 0.8071348667144775,
      "eval_ipcw_1th_event_0.75": 0.8092228174209595,
      "eval_ipcw_1th_event_1.00": 0.809169352054596,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.8012000874350139,
      "eval_loss": 3.0312469005584717,
      "eval_runtime": 0.5197,
      "eval_samples_per_second": 2158.879,
      "eval_steps_per_second": 5.772,
      "step": 140
    }
  ],
  "logging_steps": 10,
  "max_steps": 1000,
  "num_input_tokens_seen": 0,
  "num_train_epochs": 200,
  "save_steps": 10,
  "stateful_callbacks": {
    "EarlyStoppingCallback": {
      "args": {
        "early_stopping_patience": 10,
        "early_stopping_threshold": 0.0
      },
      "attributes": {
        "early_stopping_patience_counter": 0
      }
    },
    "TrainerControl": {
      "args": {
        "should_epoch_stop": false,
        "should_evaluate": false,
        "should_log": false,
        "should_save": true,
        "should_training_stop": false
      },
      "attributes": {}
    }
  },
  "total_flos": 78021961920.0,
  "train_batch_size": 256,
  "trial_name": null,
  "trial_params": null
}
