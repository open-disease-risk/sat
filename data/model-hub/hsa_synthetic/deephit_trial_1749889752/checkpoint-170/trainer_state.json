{
  "best_global_step": 70,
  "best_metric": 0.4940305879095667,
  "best_model_checkpoint": "./data/model-hub/hsa_synthetic/deephit_trial_1749889752/checkpoint-70",
  "epoch": 34.0,
  "eval_steps": 10,
  "global_step": 170,
  "is_hyper_param_search": false,
  "is_local_process_zero": true,
  "is_world_process_zero": true,
  "log_history": [
    {
      "epoch": 2.0,
      "grad_norm": 47.950279235839844,
      "learning_rate": 2.1053511481076765e-05,
      "loss": 5.3824,
      "step": 10
    },
    {
      "epoch": 4.0,
      "grad_norm": 41.63731002807617,
      "learning_rate": 4.210702296215353e-05,
      "loss": 5.5577,
      "step": 20
    },
    {
      "epoch": 6.0,
      "grad_norm": 24.749401092529297,
      "learning_rate": 6.31605344432303e-05,
      "loss": 5.8648,
      "step": 30
    },
    {
      "epoch": 8.0,
      "grad_norm": 21.77106285095215,
      "learning_rate": 8.421404592430706e-05,
      "loss": 5.9148,
      "step": 40
    },
    {
      "epoch": 8.0,
      "eval_brier_0th_event": 0.2606163024902344,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.3982435166835785,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.3299504361156256,
      "eval_ipcw_0th_event": 0.4910316821490036,
      "eval_ipcw_0th_event_0.25": 0.4843182861804962,
      "eval_ipcw_0th_event_0.50": 0.4594281315803528,
      "eval_ipcw_0th_event_0.75": 0.487540602684021,
      "eval_ipcw_0th_event_1.00": 0.5107368230819702,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.45875644546732774,
      "eval_ipcw_1th_event_0.25": 0.5403314232826233,
      "eval_ipcw_1th_event_0.50": 0.4724682867527008,
      "eval_ipcw_1th_event_0.75": 0.45558857917785645,
      "eval_ipcw_1th_event_1.00": 0.434265673160553,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.47489406380816573,
      "eval_loss": 2.933565139770508,
      "eval_runtime": 6.1125,
      "eval_samples_per_second": 183.559,
      "eval_steps_per_second": 0.491,
      "step": 40
    },
    {
      "epoch": 10.0,
      "grad_norm": 18.3281192779541,
      "learning_rate": 8.419150129688017e-05,
      "loss": 5.9262,
      "step": 50
    },
    {
      "epoch": 10.0,
      "eval_brier_0th_event": 0.2115931659936905,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.3973168134689331,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.3051574241014905,
      "eval_ipcw_0th_event": 0.48911419908949794,
      "eval_ipcw_0th_event_0.25": 0.4941921830177307,
      "eval_ipcw_0th_event_0.50": 0.462472140789032,
      "eval_ipcw_0th_event_0.75": 0.48222315311431885,
      "eval_ipcw_0th_event_1.00": 0.5058873891830444,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.4721347233573692,
      "eval_ipcw_1th_event_0.25": 0.5063676238059998,
      "eval_ipcw_1th_event_0.50": 0.48369574546813965,
      "eval_ipcw_1th_event_0.75": 0.4732198119163513,
      "eval_ipcw_1th_event_1.00": 0.4572064280509949,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.48062446122343355,
      "eval_loss": 2.9094090461730957,
      "eval_runtime": 0.5571,
      "eval_samples_per_second": 2013.846,
      "eval_steps_per_second": 5.385,
      "step": 50
    },
    {
      "epoch": 12.0,
      "grad_norm": 11.796290397644043,
      "learning_rate": 8.41238915559512e-05,
      "loss": 5.9062,
      "step": 60
    },
    {
      "epoch": 12.0,
      "eval_brier_0th_event": 0.1761341243982315,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.39665940403938293,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.28723082352153473,
      "eval_ipcw_0th_event": 0.4846326943565993,
      "eval_ipcw_0th_event_0.25": 0.4991148114204407,
      "eval_ipcw_0th_event_0.50": 0.4663408398628235,
      "eval_ipcw_0th_event_0.75": 0.4651770293712616,
      "eval_ipcw_0th_event_1.00": 0.5038368701934814,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.4961233167180714,
      "eval_ipcw_1th_event_0.25": 0.5013427138328552,
      "eval_ipcw_1th_event_0.50": 0.5005156993865967,
      "eval_ipcw_1th_event_0.75": 0.49413079023361206,
      "eval_ipcw_1th_event_1.00": 0.4941527843475342,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.4903780055373354,
      "eval_loss": 2.9190196990966797,
      "eval_runtime": 0.568,
      "eval_samples_per_second": 1975.321,
      "eval_steps_per_second": 5.282,
      "step": 60
    },
    {
      "epoch": 14.0,
      "grad_norm": 11.023723602294922,
      "learning_rate": 8.401128909972421e-05,
      "loss": 5.9318,
      "step": 70
    },
    {
      "epoch": 14.0,
      "eval_brier_0th_event": 0.15424257516860962,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.3879673480987549,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.2719889433769884,
      "eval_ipcw_0th_event": 0.493990304020609,
      "eval_ipcw_0th_event_0.25": 0.4980162978172302,
      "eval_ipcw_0th_event_0.50": 0.46808889508247375,
      "eval_ipcw_0th_event_0.75": 0.469910204410553,
      "eval_ipcw_0th_event_1.00": 0.5227599740028381,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.49407087179852455,
      "eval_ipcw_1th_event_0.25": 0.4917755424976349,
      "eval_ipcw_1th_event_0.50": 0.4959750473499298,
      "eval_ipcw_1th_event_0.75": 0.4923855662345886,
      "eval_ipcw_1th_event_1.00": 0.4949483573436737,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.4940305879095667,
      "eval_loss": 2.910083532333374,
      "eval_runtime": 0.5251,
      "eval_samples_per_second": 2136.642,
      "eval_steps_per_second": 5.713,
      "step": 70
    },
    {
      "epoch": 16.0,
      "grad_norm": 12.316259384155273,
      "learning_rate": 8.385381450572969e-05,
      "loss": 5.8959,
      "step": 80
    },
    {
      "epoch": 16.0,
      "eval_brier_0th_event": 0.14110912382602692,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.37066346406936646,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.2567545024962721,
      "eval_ipcw_0th_event": 0.493775379382418,
      "eval_ipcw_0th_event_0.25": 0.4965150058269501,
      "eval_ipcw_0th_event_0.50": 0.4692733883857727,
      "eval_ipcw_0th_event_0.75": 0.45910653471946716,
      "eval_ipcw_0th_event_1.00": 0.5296249389648438,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.47630998257719004,
      "eval_ipcw_1th_event_0.25": 0.47222772240638733,
      "eval_ipcw_1th_event_0.50": 0.47313177585601807,
      "eval_ipcw_1th_event_0.75": 0.47480151057243347,
      "eval_ipcw_1th_event_1.00": 0.4799993634223938,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.485042680979804,
      "eval_loss": 2.93398118019104,
      "eval_runtime": 0.5369,
      "eval_samples_per_second": 2089.872,
      "eval_steps_per_second": 5.588,
      "step": 80
    },
    {
      "epoch": 18.0,
      "grad_norm": 14.314002990722656,
      "learning_rate": 8.36516364017072e-05,
      "loss": 5.9402,
      "step": 90
    },
    {
      "epoch": 18.0,
      "eval_brier_0th_event": 0.13370434939861298,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.3519138693809509,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.24363441014614481,
      "eval_ipcw_0th_event": 0.4991877916898025,
      "eval_ipcw_0th_event_0.25": 0.4924059212207794,
      "eval_ipcw_0th_event_0.50": 0.47004711627960205,
      "eval_ipcw_0th_event_0.75": 0.4678994417190552,
      "eval_ipcw_0th_event_1.00": 0.5372699499130249,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.4832011835410578,
      "eval_ipcw_1th_event_0.25": 0.5045108199119568,
      "eval_ipcw_1th_event_0.50": 0.48590946197509766,
      "eval_ipcw_1th_event_0.75": 0.4767416715621948,
      "eval_ipcw_1th_event_1.00": 0.48141124844551086,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.4911944876154302,
      "eval_loss": 2.91310977935791,
      "eval_runtime": 0.5412,
      "eval_samples_per_second": 2073.301,
      "eval_steps_per_second": 5.544,
      "step": 90
    },
    {
      "epoch": 20.0,
      "grad_norm": 10.814306259155273,
      "learning_rate": 8.340497128503454e-05,
      "loss": 5.9176,
      "step": 100
    },
    {
      "epoch": 20.0,
      "eval_brier_0th_event": 0.12857593595981598,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.33225560188293457,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.2311861156154869,
      "eval_ipcw_0th_event": 0.4952970022119386,
      "eval_ipcw_0th_event_0.25": 0.49086639285087585,
      "eval_ipcw_0th_event_0.50": 0.471164733171463,
      "eval_ipcw_0th_event_0.75": 0.47103261947631836,
      "eval_ipcw_0th_event_1.00": 0.5253852605819702,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.48946169765607495,
      "eval_ipcw_1th_event_0.25": 0.5240617394447327,
      "eval_ipcw_1th_event_0.50": 0.4995770752429962,
      "eval_ipcw_1th_event_0.75": 0.48156532645225525,
      "eval_ipcw_1th_event_1.00": 0.4818168878555298,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.4923793499340068,
      "eval_loss": 2.912175178527832,
      "eval_runtime": 0.5386,
      "eval_samples_per_second": 2083.295,
      "eval_steps_per_second": 5.57,
      "step": 100
    },
    {
      "epoch": 22.0,
      "grad_norm": 12.221745491027832,
      "learning_rate": 8.311408329089693e-05,
      "loss": 5.911,
      "step": 110
    },
    {
      "epoch": 22.0,
      "eval_brier_0th_event": 0.12571027874946594,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.3105508089065552,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.21882963811756082,
      "eval_ipcw_0th_event": 0.49088503392448135,
      "eval_ipcw_0th_event_0.25": 0.4912930727005005,
      "eval_ipcw_0th_event_0.50": 0.4735337197780609,
      "eval_ipcw_0th_event_0.75": 0.4699229300022125,
      "eval_ipcw_0th_event_1.00": 0.5141183137893677,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.4629527516572874,
      "eval_ipcw_1th_event_0.25": 0.5007782578468323,
      "eval_ipcw_1th_event_0.50": 0.4624514579772949,
      "eval_ipcw_1th_event_0.75": 0.4543842375278473,
      "eval_ipcw_1th_event_1.00": 0.4602408707141876,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.4769188927908844,
      "eval_loss": 2.9074597358703613,
      "eval_runtime": 0.5638,
      "eval_samples_per_second": 1989.99,
      "eval_steps_per_second": 5.321,
      "step": 110
    },
    {
      "epoch": 24.0,
      "grad_norm": 13.544120788574219,
      "learning_rate": 8.277928390944444e-05,
      "loss": 5.9147,
      "step": 120
    },
    {
      "epoch": 24.0,
      "eval_brier_0th_event": 0.12421464920043945,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.28452080488204956,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.20497402868905695,
      "eval_ipcw_0th_event": 0.4936305190367942,
      "eval_ipcw_0th_event_0.25": 0.4933515787124634,
      "eval_ipcw_0th_event_0.50": 0.47785454988479614,
      "eval_ipcw_0th_event_0.75": 0.4740654528141022,
      "eval_ipcw_0th_event_1.00": 0.51526939868927,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.48500978888957325,
      "eval_ipcw_1th_event_0.25": 0.5231183767318726,
      "eval_ipcw_1th_event_0.50": 0.4872773289680481,
      "eval_ipcw_1th_event_0.75": 0.4838671088218689,
      "eval_ipcw_1th_event_1.00": 0.4753565192222595,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.48932015396318373,
      "eval_loss": 2.878389596939087,
      "eval_runtime": 0.5293,
      "eval_samples_per_second": 2119.789,
      "eval_steps_per_second": 5.668,
      "step": 120
    },
    {
      "epoch": 26.0,
      "grad_norm": 16.56651496887207,
      "learning_rate": 8.240093165224055e-05,
      "loss": 5.8781,
      "step": 130
    },
    {
      "epoch": 26.0,
      "eval_brier_0th_event": 0.12444309145212173,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.24255017936229706,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.18394333392426754,
      "eval_ipcw_0th_event": 0.49732882137899836,
      "eval_ipcw_0th_event_0.25": 0.4948067367076874,
      "eval_ipcw_0th_event_0.50": 0.4822390675544739,
      "eval_ipcw_0th_event_0.75": 0.481097549200058,
      "eval_ipcw_0th_event_1.00": 0.5168280005455017,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.47679424340009113,
      "eval_ipcw_1th_event_0.25": 0.5210650563240051,
      "eval_ipcw_1th_event_0.50": 0.4854503571987152,
      "eval_ipcw_1th_event_0.75": 0.478719562292099,
      "eval_ipcw_1th_event_1.00": 0.46020156145095825,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.4870615323895447,
      "eval_loss": 2.8564319610595703,
      "eval_runtime": 0.5418,
      "eval_samples_per_second": 2070.717,
      "eval_steps_per_second": 5.537,
      "step": 130
    },
    {
      "epoch": 28.0,
      "grad_norm": 14.460041999816895,
      "learning_rate": 8.197943166835896e-05,
      "loss": 5.8485,
      "step": 140
    },
    {
      "epoch": 28.0,
      "eval_brier_0th_event": 0.1245817244052887,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.20838265120983124,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.1667991353370779,
      "eval_ipcw_0th_event": 0.49754722046197275,
      "eval_ipcw_0th_event_0.25": 0.4965707063674927,
      "eval_ipcw_0th_event_0.50": 0.4869037866592407,
      "eval_ipcw_0th_event_0.75": 0.4846096336841583,
      "eval_ipcw_0th_event_1.00": 0.5121537446975708,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.46617116719556484,
      "eval_ipcw_1th_event_0.25": 0.5123862028121948,
      "eval_ipcw_1th_event_0.50": 0.4740735590457916,
      "eval_ipcw_1th_event_0.75": 0.4651840329170227,
      "eval_ipcw_1th_event_1.00": 0.45163121819496155,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.4818591938287688,
      "eval_loss": 2.8760130405426025,
      "eval_runtime": 0.5255,
      "eval_samples_per_second": 2135.223,
      "eval_steps_per_second": 5.709,
      "step": 140
    },
    {
      "epoch": 30.0,
      "grad_norm": 13.61838436126709,
      "learning_rate": 8.151523531053982e-05,
      "loss": 5.8707,
      "step": 150
    },
    {
      "epoch": 30.0,
      "eval_brier_0th_event": 0.1230325847864151,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.1830856204032898,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.15328623207903125,
      "eval_ipcw_0th_event": 0.4968229157201359,
      "eval_ipcw_0th_event_0.25": 0.4994587004184723,
      "eval_ipcw_0th_event_0.50": 0.4916815161705017,
      "eval_ipcw_0th_event_0.75": 0.48630356788635254,
      "eval_ipcw_0th_event_1.00": 0.5061278343200684,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.4627747769505868,
      "eval_ipcw_1th_event_0.25": 0.5065295696258545,
      "eval_ipcw_1th_event_0.50": 0.46792131662368774,
      "eval_ipcw_1th_event_0.75": 0.4606543779373169,
      "eval_ipcw_1th_event_1.00": 0.4510384798049927,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.4797988463353613,
      "eval_loss": 2.875662326812744,
      "eval_runtime": 0.5275,
      "eval_samples_per_second": 2126.954,
      "eval_steps_per_second": 5.687,
      "step": 150
    },
    {
      "epoch": 32.0,
      "grad_norm": 13.596597671508789,
      "learning_rate": 8.100883965186995e-05,
      "loss": 5.86,
      "step": 160
    },
    {
      "epoch": 32.0,
      "eval_brier_0th_event": 0.12117210775613785,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.16443954408168793,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.1429694697779354,
      "eval_ipcw_0th_event": 0.49597082594956055,
      "eval_ipcw_0th_event_0.25": 0.4988314211368561,
      "eval_ipcw_0th_event_0.50": 0.49334681034088135,
      "eval_ipcw_0th_event_0.75": 0.48613959550857544,
      "eval_ipcw_0th_event_1.00": 0.5034929513931274,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.4616978710774359,
      "eval_ipcw_1th_event_0.25": 0.4995173215866089,
      "eval_ipcw_1th_event_0.50": 0.4642532467842102,
      "eval_ipcw_1th_event_0.75": 0.45908212661743164,
      "eval_ipcw_1th_event_1.00": 0.4530666768550873,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.4788343485134981,
      "eval_loss": 2.887592315673828,
      "eval_runtime": 0.5541,
      "eval_samples_per_second": 2024.835,
      "eval_steps_per_second": 5.414,
      "step": 160
    },
    {
      "epoch": 34.0,
      "grad_norm": 11.352957725524902,
      "learning_rate": 8.046078695350448e-05,
      "loss": 5.8855,
      "step": 170
    },
    {
      "epoch": 34.0,
      "eval_brier_0th_event": 0.11983729153871536,
      "eval_brier_0th_event_n": 328,
      "eval_brier_1th_event": 0.14934295415878296,
      "eval_brier_1th_event_n": 333,
      "eval_brier_weighted_avg": 0.13470171763929403,
      "eval_ipcw_0th_event": 0.4910171978482593,
      "eval_ipcw_0th_event_0.25": 0.487491250038147,
      "eval_ipcw_0th_event_0.50": 0.4910128712654114,
      "eval_ipcw_0th_event_0.75": 0.47700440883636475,
      "eval_ipcw_0th_event_1.00": 0.5017480850219727,
      "eval_ipcw_0th_event_n": 1122,
      "eval_ipcw_1th_event": 0.45653161370436735,
      "eval_ipcw_1th_event_0.25": 0.4817618727684021,
      "eval_ipcw_1th_event_0.50": 0.4530525207519531,
      "eval_ipcw_1th_event_0.75": 0.4533182382583618,
      "eval_ipcw_1th_event_1.00": 0.4544156789779663,
      "eval_ipcw_1th_event_n": 1122,
      "eval_ipcw_weighted_avg": 0.4737744057763134,
      "eval_loss": 2.872525453567505,
      "eval_runtime": 0.5491,
      "eval_samples_per_second": 2043.224,
      "eval_steps_per_second": 5.463,
      "step": 170
    }
  ],
  "logging_steps": 10,
  "max_steps": 1000,
  "num_input_tokens_seen": 0,
  "num_train_epochs": 200,
  "save_steps": 10,
  "stateful_callbacks": {
    "EarlyStoppingCallback": {
      "args": {
        "early_stopping_patience": 10,
        "early_stopping_threshold": 0.0
      },
      "attributes": {
        "early_stopping_patience_counter": 10
      }
    },
    "TrainerControl": {
      "args": {
        "should_epoch_stop": false,
        "should_evaluate": false,
        "should_log": false,
        "should_save": true,
        "should_training_stop": true
      },
      "attributes": {}
    }
  },
  "total_flos": 29575830240.0,
  "train_batch_size": 256,
  "trial_name": null,
  "trial_params": null
}
