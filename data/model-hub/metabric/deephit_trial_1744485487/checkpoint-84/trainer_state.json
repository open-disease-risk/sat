{
  "best_global_step": 84,
  "best_metric": 0.6425452539894317,
  "best_model_checkpoint": "./data/model-hub/metabric/deephit_trial_1744485487/checkpoint-84",
  "epoch": 42.0,
  "eval_steps": 1,
  "global_step": 84,
  "is_hyper_param_search": false,
  "is_local_process_zero": true,
  "is_world_process_zero": true,
  "log_history": [
    {
      "epoch": 0.5,
      "grad_norm": 4.615148067474365,
      "learning_rate": 4.836115737737349e-06,
      "loss": 6.8196,
      "step": 1
    },
    {
      "epoch": 1.0,
      "grad_norm": 4.453381538391113,
      "learning_rate": 9.672231475474698e-06,
      "loss": 6.0626,
      "step": 2
    },
    {
      "epoch": 1.5,
      "grad_norm": 5.264559268951416,
      "learning_rate": 1.4508347213212043e-05,
      "loss": 5.7023,
      "step": 3
    },
    {
      "epoch": 2.0,
      "grad_norm": 5.128565788269043,
      "learning_rate": 1.9344462950949396e-05,
      "loss": 5.3536,
      "step": 4
    },
    {
      "epoch": 2.5,
      "grad_norm": 5.373578071594238,
      "learning_rate": 2.418057868868674e-05,
      "loss": 5.2609,
      "step": 5
    },
    {
      "epoch": 3.0,
      "grad_norm": 5.970851898193359,
      "learning_rate": 2.9016694426424087e-05,
      "loss": 5.3148,
      "step": 6
    },
    {
      "epoch": 3.5,
      "grad_norm": 6.0600128173828125,
      "learning_rate": 3.385281016416143e-05,
      "loss": 5.0864,
      "step": 7
    },
    {
      "epoch": 4.0,
      "grad_norm": 5.973949909210205,
      "learning_rate": 3.868892590189879e-05,
      "loss": 5.3695,
      "step": 8
    },
    {
      "epoch": 4.5,
      "grad_norm": 6.495736598968506,
      "learning_rate": 4.352504163963614e-05,
      "loss": 5.1457,
      "step": 9
    },
    {
      "epoch": 5.0,
      "grad_norm": 7.795965671539307,
      "learning_rate": 4.836115737737348e-05,
      "loss": 5.352,
      "step": 10
    },
    {
      "epoch": 5.5,
      "grad_norm": 7.535306453704834,
      "learning_rate": 5.3197273115110835e-05,
      "loss": 5.2733,
      "step": 11
    },
    {
      "epoch": 6.0,
      "grad_norm": 7.765922546386719,
      "learning_rate": 5.8033388852848174e-05,
      "loss": 5.4168,
      "step": 12
    },
    {
      "epoch": 6.5,
      "grad_norm": 7.902117729187012,
      "learning_rate": 6.286950459058553e-05,
      "loss": 5.4541,
      "step": 13
    },
    {
      "epoch": 7.0,
      "grad_norm": 9.548066139221191,
      "learning_rate": 6.770562032832286e-05,
      "loss": 5.4299,
      "step": 14
    },
    {
      "epoch": 7.5,
      "grad_norm": 8.58514404296875,
      "learning_rate": 7.254173606606023e-05,
      "loss": 5.675,
      "step": 15
    },
    {
      "epoch": 8.0,
      "grad_norm": 9.493284225463867,
      "learning_rate": 7.737785180379758e-05,
      "loss": 5.4701,
      "step": 16
    },
    {
      "epoch": 8.5,
      "grad_norm": 8.932909965515137,
      "learning_rate": 8.221396754153492e-05,
      "loss": 5.6037,
      "step": 17
    },
    {
      "epoch": 9.0,
      "grad_norm": 8.884160995483398,
      "learning_rate": 8.705008327927227e-05,
      "loss": 5.8921,
      "step": 18
    },
    {
      "epoch": 9.5,
      "grad_norm": 9.785011291503906,
      "learning_rate": 9.188619901700961e-05,
      "loss": 5.666,
      "step": 19
    },
    {
      "epoch": 10.0,
      "grad_norm": 8.13791275024414,
      "learning_rate": 9.672231475474697e-05,
      "loss": 5.9161,
      "step": 20
    },
    {
      "epoch": 10.5,
      "grad_norm": 8.838546752929688,
      "learning_rate": 0.00010155843049248432,
      "loss": 5.7359,
      "step": 21
    },
    {
      "epoch": 11.0,
      "grad_norm": 9.037692070007324,
      "learning_rate": 0.00010639454623022167,
      "loss": 5.9145,
      "step": 22
    },
    {
      "epoch": 11.5,
      "grad_norm": 9.22815990447998,
      "learning_rate": 0.000111230661967959,
      "loss": 5.8087,
      "step": 23
    },
    {
      "epoch": 12.0,
      "grad_norm": 8.165709495544434,
      "learning_rate": 0.00011606677770569635,
      "loss": 5.8953,
      "step": 24
    },
    {
      "epoch": 12.5,
      "grad_norm": 8.7044038772583,
      "learning_rate": 0.0001209028934434337,
      "loss": 5.9199,
      "step": 25
    },
    {
      "epoch": 13.0,
      "grad_norm": 8.59471321105957,
      "learning_rate": 0.00012573900918117105,
      "loss": 5.8773,
      "step": 26
    },
    {
      "epoch": 13.5,
      "grad_norm": 8.406805992126465,
      "learning_rate": 0.0001305751249189084,
      "loss": 5.8068,
      "step": 27
    },
    {
      "epoch": 14.0,
      "grad_norm": 8.450003623962402,
      "learning_rate": 0.00013541124065664573,
      "loss": 5.8962,
      "step": 28
    },
    {
      "epoch": 14.5,
      "grad_norm": 8.160512924194336,
      "learning_rate": 0.00014024735639438308,
      "loss": 5.967,
      "step": 29
    },
    {
      "epoch": 15.0,
      "grad_norm": 8.705376625061035,
      "learning_rate": 0.00014508347213212046,
      "loss": 5.7375,
      "step": 30
    },
    {
      "epoch": 15.5,
      "grad_norm": 8.219346046447754,
      "learning_rate": 0.0001499195878698578,
      "loss": 5.8439,
      "step": 31
    },
    {
      "epoch": 16.0,
      "grad_norm": 8.919585227966309,
      "learning_rate": 0.00015475570360759517,
      "loss": 6.0817,
      "step": 32
    },
    {
      "epoch": 16.5,
      "grad_norm": 8.517149925231934,
      "learning_rate": 0.0001595918193453325,
      "loss": 5.8465,
      "step": 33
    },
    {
      "epoch": 17.0,
      "grad_norm": 7.824453353881836,
      "learning_rate": 0.00016442793508306984,
      "loss": 6.0943,
      "step": 34
    },
    {
      "epoch": 17.5,
      "grad_norm": 8.320103645324707,
      "learning_rate": 0.0001692640508208072,
      "loss": 5.8621,
      "step": 35
    },
    {
      "epoch": 18.0,
      "grad_norm": 8.055375099182129,
      "learning_rate": 0.00017410016655854455,
      "loss": 5.8959,
      "step": 36
    },
    {
      "epoch": 18.5,
      "grad_norm": 7.987359046936035,
      "learning_rate": 0.0001789362822962819,
      "loss": 5.8223,
      "step": 37
    },
    {
      "epoch": 19.0,
      "grad_norm": 8.855926513671875,
      "learning_rate": 0.00018377239803401923,
      "loss": 5.9922,
      "step": 38
    },
    {
      "epoch": 19.5,
      "grad_norm": 7.640528202056885,
      "learning_rate": 0.00018860851377175658,
      "loss": 6.003,
      "step": 39
    },
    {
      "epoch": 20.0,
      "grad_norm": 8.246346473693848,
      "learning_rate": 0.00019344462950949393,
      "loss": 5.7056,
      "step": 40
    },
    {
      "epoch": 20.5,
      "grad_norm": 8.580204963684082,
      "learning_rate": 0.00019828074524723126,
      "loss": 5.8319,
      "step": 41
    },
    {
      "epoch": 21.0,
      "grad_norm": 6.122634410858154,
      "learning_rate": 0.00020311686098496863,
      "loss": 6.0848,
      "step": 42
    },
    {
      "epoch": 21.5,
      "grad_norm": 6.987716197967529,
      "learning_rate": 0.00020795297672270596,
      "loss": 5.8974,
      "step": 43
    },
    {
      "epoch": 22.0,
      "grad_norm": 7.64445686340332,
      "learning_rate": 0.00021278909246044334,
      "loss": 5.8452,
      "step": 44
    },
    {
      "epoch": 22.5,
      "grad_norm": 6.2057013511657715,
      "learning_rate": 0.00021762520819818066,
      "loss": 5.9855,
      "step": 45
    },
    {
      "epoch": 23.0,
      "grad_norm": 7.599564075469971,
      "learning_rate": 0.000222461323935918,
      "loss": 5.7883,
      "step": 46
    },
    {
      "epoch": 23.5,
      "grad_norm": 7.553062438964844,
      "learning_rate": 0.00022729743967365537,
      "loss": 5.7998,
      "step": 47
    },
    {
      "epoch": 24.0,
      "grad_norm": 4.963207721710205,
      "learning_rate": 0.0002321335554113927,
      "loss": 6.0668,
      "step": 48
    },
    {
      "epoch": 24.5,
      "grad_norm": 6.7874674797058105,
      "learning_rate": 0.00023696967114913007,
      "loss": 5.8396,
      "step": 49
    },
    {
      "epoch": 25.0,
      "grad_norm": 5.394333362579346,
      "learning_rate": 0.0002418057868868674,
      "loss": 6.0439,
      "step": 50
    },
    {
      "epoch": 25.5,
      "grad_norm": 4.465005397796631,
      "learning_rate": 0.00024664190262460475,
      "loss": 5.932,
      "step": 51
    },
    {
      "epoch": 26.0,
      "grad_norm": 6.970148086547852,
      "learning_rate": 0.0002514780183623421,
      "loss": 5.8539,
      "step": 52
    },
    {
      "epoch": 26.5,
      "grad_norm": 4.801332950592041,
      "learning_rate": 0.00025631413410007946,
      "loss": 5.9248,
      "step": 53
    },
    {
      "epoch": 27.0,
      "grad_norm": 3.807326316833496,
      "learning_rate": 0.0002611502498378168,
      "loss": 5.9508,
      "step": 54
    },
    {
      "epoch": 27.5,
      "grad_norm": 3.8387320041656494,
      "learning_rate": 0.00026598636557555416,
      "loss": 5.913,
      "step": 55
    },
    {
      "epoch": 28.0,
      "grad_norm": 4.700917720794678,
      "learning_rate": 0.00027082248131329146,
      "loss": 5.8712,
      "step": 56
    },
    {
      "epoch": 28.5,
      "grad_norm": 3.626152276992798,
      "learning_rate": 0.00027565859705102887,
      "loss": 5.9948,
      "step": 57
    },
    {
      "epoch": 29.0,
      "grad_norm": 4.705303192138672,
      "learning_rate": 0.00028049471278876616,
      "loss": 5.8737,
      "step": 58
    },
    {
      "epoch": 29.5,
      "grad_norm": 3.6241815090179443,
      "learning_rate": 0.00028533082852650357,
      "loss": 5.9623,
      "step": 59
    },
    {
      "epoch": 30.0,
      "grad_norm": 4.041842460632324,
      "learning_rate": 0.0002901669442642409,
      "loss": 5.8048,
      "step": 60
    },
    {
      "epoch": 30.5,
      "grad_norm": 3.7841408252716064,
      "learning_rate": 0.0002950030600019782,
      "loss": 6.028,
      "step": 61
    },
    {
      "epoch": 31.0,
      "grad_norm": 5.4711198806762695,
      "learning_rate": 0.0002998391757397156,
      "loss": 5.8625,
      "step": 62
    },
    {
      "epoch": 31.5,
      "grad_norm": 3.421454429626465,
      "learning_rate": 0.0003046752914774529,
      "loss": 5.9441,
      "step": 63
    },
    {
      "epoch": 32.0,
      "grad_norm": 3.7192749977111816,
      "learning_rate": 0.00030951140721519033,
      "loss": 6.0592,
      "step": 64
    },
    {
      "epoch": 32.5,
      "grad_norm": 3.3699302673339844,
      "learning_rate": 0.00031434752295292763,
      "loss": 6.1065,
      "step": 65
    },
    {
      "epoch": 33.0,
      "grad_norm": 4.808069229125977,
      "learning_rate": 0.000319183638690665,
      "loss": 5.8052,
      "step": 66
    },
    {
      "epoch": 33.5,
      "grad_norm": 3.9454538822174072,
      "learning_rate": 0.00032401975442840233,
      "loss": 6.143,
      "step": 67
    },
    {
      "epoch": 34.0,
      "grad_norm": 6.316306114196777,
      "learning_rate": 0.0003288558701661397,
      "loss": 5.7127,
      "step": 68
    },
    {
      "epoch": 34.5,
      "grad_norm": 3.4660885334014893,
      "learning_rate": 0.00033369198590387704,
      "loss": 5.8795,
      "step": 69
    },
    {
      "epoch": 35.0,
      "grad_norm": 5.510232448577881,
      "learning_rate": 0.0003385281016416144,
      "loss": 6.1253,
      "step": 70
    },
    {
      "epoch": 35.5,
      "grad_norm": 5.120131492614746,
      "learning_rate": 0.0003433642173793517,
      "loss": 6.1903,
      "step": 71
    },
    {
      "epoch": 36.0,
      "grad_norm": 5.167788982391357,
      "learning_rate": 0.0003482003331170891,
      "loss": 5.6999,
      "step": 72
    },
    {
      "epoch": 36.5,
      "grad_norm": 3.926464319229126,
      "learning_rate": 0.0003530364488548264,
      "loss": 5.9429,
      "step": 73
    },
    {
      "epoch": 37.0,
      "grad_norm": 3.9708266258239746,
      "learning_rate": 0.0003578725645925638,
      "loss": 6.078,
      "step": 74
    },
    {
      "epoch": 37.5,
      "grad_norm": 3.4658567905426025,
      "learning_rate": 0.0003627086803303011,
      "loss": 6.0231,
      "step": 75
    },
    {
      "epoch": 38.0,
      "grad_norm": 5.416472434997559,
      "learning_rate": 0.00036754479606803845,
      "loss": 5.9809,
      "step": 76
    },
    {
      "epoch": 38.5,
      "grad_norm": 3.6049282550811768,
      "learning_rate": 0.0003723809118057758,
      "loss": 5.8253,
      "step": 77
    },
    {
      "epoch": 39.0,
      "grad_norm": 4.963522434234619,
      "learning_rate": 0.00037721702754351316,
      "loss": 6.2967,
      "step": 78
    },
    {
      "epoch": 39.5,
      "grad_norm": 4.225266456604004,
      "learning_rate": 0.0003820531432812505,
      "loss": 5.8822,
      "step": 79
    },
    {
      "epoch": 40.0,
      "grad_norm": 5.726235866546631,
      "learning_rate": 0.00038688925901898786,
      "loss": 6.0437,
      "step": 80
    },
    {
      "epoch": 40.0,
      "eval_brier_0th_event": 0.200774105039635,
      "eval_brier_0th_event_n": 266,
      "eval_brier_avg": 0.200774105039635,
      "eval_brier_weighted_avg": 0.200774105039635,
      "eval_ipcw": 0.6276873356135493,
      "eval_ipcw_0th_event": 0.6276873356135493,
      "eval_ipcw_0th_event_0.25": 0.6418394020934526,
      "eval_ipcw_0th_event_0.5": 0.6458731527899252,
      "eval_ipcw_0th_event_0.75": 0.6326015274782798,
      "eval_ipcw_0th_event_1.0": 0.6276873356135493,
      "eval_ipcw_0th_event_n": 266,
      "eval_ipcw_avg": 0.6370003544938018,
      "eval_ipcw_avg_0th_event": 0.6370003544938018,
      "eval_ipcw_weighted_avg": 0.6370003544938018,
      "eval_loss": 2.9887804985046387,
      "eval_runtime": 0.0979,
      "eval_samples_per_second": 4536.161,
      "eval_steps_per_second": 10.217,
      "step": 80
    },
    {
      "epoch": 40.5,
      "grad_norm": 3.773071527481079,
      "learning_rate": 0.00038688813117156845,
      "loss": 5.9698,
      "step": 81
    },
    {
      "epoch": 40.5,
      "eval_brier_0th_event": 0.20062816179634632,
      "eval_brier_0th_event_n": 266,
      "eval_brier_avg": 0.20062816179634632,
      "eval_brier_weighted_avg": 0.20062816179634632,
      "eval_ipcw": 0.6273617751354623,
      "eval_ipcw_0th_event": 0.6273617751354623,
      "eval_ipcw_0th_event_0.25": 0.6462676006064615,
      "eval_ipcw_0th_event_0.5": 0.6489626731277198,
      "eval_ipcw_0th_event_0.75": 0.6340253983652256,
      "eval_ipcw_0th_event_1.0": 0.6273617751354623,
      "eval_ipcw_0th_event_n": 266,
      "eval_ipcw_avg": 0.6391543618087172,
      "eval_ipcw_avg_0th_event": 0.6391543618087172,
      "eval_ipcw_weighted_avg": 0.6391543618087172,
      "eval_loss": 2.9931464195251465,
      "eval_runtime": 0.0975,
      "eval_samples_per_second": 4554.132,
      "eval_steps_per_second": 10.257,
      "step": 81
    },
    {
      "epoch": 41.0,
      "grad_norm": 4.980772972106934,
      "learning_rate": 0.00038688474764246177,
      "loss": 5.9495,
      "step": 82
    },
    {
      "epoch": 41.0,
      "eval_brier_0th_event": 0.20029078142236081,
      "eval_brier_0th_event_n": 266,
      "eval_brier_avg": 0.20029078142236081,
      "eval_brier_weighted_avg": 0.20029078142236081,
      "eval_ipcw": 0.6267400221874465,
      "eval_ipcw_0th_event": 0.6267400221874465,
      "eval_ipcw_0th_event_0.25": 0.6511468418129605,
      "eval_ipcw_0th_event_0.5": 0.6515800302647003,
      "eval_ipcw_0th_event_0.75": 0.6343155259093156,
      "eval_ipcw_0th_event_1.0": 0.6267400221874465,
      "eval_ipcw_0th_event_n": 266,
      "eval_ipcw_avg": 0.6409456050436058,
      "eval_ipcw_avg_0th_event": 0.6409456050436058,
      "eval_ipcw_weighted_avg": 0.6409456050436058,
      "eval_loss": 3.0028090476989746,
      "eval_runtime": 0.0983,
      "eval_samples_per_second": 4516.6,
      "eval_steps_per_second": 10.173,
      "step": 82
    },
    {
      "epoch": 41.5,
      "grad_norm": 3.4538371562957764,
      "learning_rate": 0.000386879108471122,
      "loss": 6.0641,
      "step": 83
    },
    {
      "epoch": 41.5,
      "eval_brier_0th_event": 0.2001374086877235,
      "eval_brier_0th_event_n": 266,
      "eval_brier_avg": 0.2001374086877235,
      "eval_brier_weighted_avg": 0.2001374086877235,
      "eval_ipcw": 0.6253705817248938,
      "eval_ipcw_0th_event": 0.6253705817248938,
      "eval_ipcw_0th_event_0.25": 0.6540173033912123,
      "eval_ipcw_0th_event_0.5": 0.6530174670800545,
      "eval_ipcw_0th_event_0.75": 0.6343610989404933,
      "eval_ipcw_0th_event_1.0": 0.6253705817248938,
      "eval_ipcw_0th_event_n": 266,
      "eval_ipcw_avg": 0.6416916127841634,
      "eval_ipcw_avg_0th_event": 0.6416916127841634,
      "eval_ipcw_weighted_avg": 0.6416916127841634,
      "eval_loss": 2.9985616207122803,
      "eval_runtime": 0.0839,
      "eval_samples_per_second": 5294.604,
      "eval_steps_per_second": 11.925,
      "step": 83
    },
    {
      "epoch": 42.0,
      "grad_norm": 4.860600471496582,
      "learning_rate": 0.00038687121372330566,
      "loss": 5.7299,
      "step": 84
    },
    {
      "epoch": 42.0,
      "eval_brier_0th_event": 0.19990947952410743,
      "eval_brier_0th_event_n": 266,
      "eval_brier_avg": 0.19990947952410743,
      "eval_brier_weighted_avg": 0.19990947952410743,
      "eval_ipcw": 0.6246534707946622,
      "eval_ipcw_0th_event": 0.6246534707946622,
      "eval_ipcw_0th_event_0.25": 0.6567615640251857,
      "eval_ipcw_0th_event_0.5": 0.6543501152082226,
      "eval_ipcw_0th_event_0.75": 0.6344158659296566,
      "eval_ipcw_0th_event_1.0": 0.6246534707946622,
      "eval_ipcw_0th_event_n": 266,
      "eval_ipcw_avg": 0.6425452539894317,
      "eval_ipcw_avg_0th_event": 0.6425452539894317,
      "eval_ipcw_weighted_avg": 0.6425452539894317,
      "eval_loss": 3.029846668243408,
      "eval_runtime": 0.0858,
      "eval_samples_per_second": 5177.117,
      "eval_steps_per_second": 11.66,
      "step": 84
    }
  ],
  "logging_steps": 1,
  "max_steps": 1000,
  "num_input_tokens_seen": 0,
  "num_train_epochs": 500,
  "save_steps": 1,
  "stateful_callbacks": {
    "EarlyStoppingCallback": {
      "args": {
        "early_stopping_patience": 10,
        "early_stopping_threshold": 0.0
      },
      "attributes": {
        "early_stopping_patience_counter": 0
      }
    },
    "TrainerControl": {
      "args": {
        "should_epoch_stop": false,
        "should_evaluate": false,
        "should_log": false,
        "should_save": true,
        "should_training_stop": false
      },
      "attributes": {}
    }
  },
  "total_flos": 18215366400.0,
  "train_batch_size": 256,
  "trial_name": null,
  "trial_params": null
}
