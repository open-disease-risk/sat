{
  "best_global_step": 85,
  "best_metric": 0.621983050217189,
  "best_model_checkpoint": "./data/model-hub/metabric/deephit_trial_1744483993/checkpoint-85",
  "epoch": 42.5,
  "eval_steps": 1,
  "global_step": 85,
  "is_hyper_param_search": false,
  "is_local_process_zero": true,
  "is_world_process_zero": true,
  "log_history": [
    {
      "epoch": 0.5,
      "grad_norm": 6.056187152862549,
      "learning_rate": 1.1322209203976209e-05,
      "loss": 6.5844,
      "step": 1
    },
    {
      "epoch": 1.0,
      "grad_norm": 7.5659942626953125,
      "learning_rate": 2.2644418407952418e-05,
      "loss": 5.5044,
      "step": 2
    },
    {
      "epoch": 1.5,
      "grad_norm": 6.152740955352783,
      "learning_rate": 3.396662761192862e-05,
      "loss": 5.7025,
      "step": 3
    },
    {
      "epoch": 2.0,
      "grad_norm": 7.879515171051025,
      "learning_rate": 4.5288836815904836e-05,
      "loss": 5.1111,
      "step": 4
    },
    {
      "epoch": 2.5,
      "grad_norm": 6.789657115936279,
      "learning_rate": 5.661104601988104e-05,
      "loss": 5.129,
      "step": 5
    },
    {
      "epoch": 3.0,
      "grad_norm": 6.991711139678955,
      "learning_rate": 6.793325522385724e-05,
      "loss": 5.3439,
      "step": 6
    },
    {
      "epoch": 3.5,
      "grad_norm": 6.878422260284424,
      "learning_rate": 7.925546442783344e-05,
      "loss": 4.9672,
      "step": 7
    },
    {
      "epoch": 4.0,
      "grad_norm": 7.856958389282227,
      "learning_rate": 9.057767363180967e-05,
      "loss": 5.1641,
      "step": 8
    },
    {
      "epoch": 4.5,
      "grad_norm": 7.539023399353027,
      "learning_rate": 0.00010189988283578588,
      "loss": 5.1252,
      "step": 9
    },
    {
      "epoch": 5.0,
      "grad_norm": 9.849246978759766,
      "learning_rate": 0.00011322209203976208,
      "loss": 5.0555,
      "step": 10
    },
    {
      "epoch": 5.5,
      "grad_norm": 8.11949634552002,
      "learning_rate": 0.0001245443012437383,
      "loss": 5.3867,
      "step": 11
    },
    {
      "epoch": 6.0,
      "grad_norm": 11.08288860321045,
      "learning_rate": 0.00013586651044771448,
      "loss": 4.9297,
      "step": 12
    },
    {
      "epoch": 6.5,
      "grad_norm": 10.305304527282715,
      "learning_rate": 0.0001471887196516907,
      "loss": 5.1946,
      "step": 13
    },
    {
      "epoch": 7.0,
      "grad_norm": 7.94261360168457,
      "learning_rate": 0.0001585109288556669,
      "loss": 5.6386,
      "step": 14
    },
    {
      "epoch": 7.5,
      "grad_norm": 10.270990371704102,
      "learning_rate": 0.00016983313805964313,
      "loss": 5.36,
      "step": 15
    },
    {
      "epoch": 8.0,
      "grad_norm": 9.395792007446289,
      "learning_rate": 0.00018115534726361935,
      "loss": 5.7261,
      "step": 16
    },
    {
      "epoch": 8.5,
      "grad_norm": 10.30586051940918,
      "learning_rate": 0.00019247755646759553,
      "loss": 5.4688,
      "step": 17
    },
    {
      "epoch": 9.0,
      "grad_norm": 9.188907623291016,
      "learning_rate": 0.00020379976567157175,
      "loss": 5.8314,
      "step": 18
    },
    {
      "epoch": 9.5,
      "grad_norm": 9.914107322692871,
      "learning_rate": 0.00021512197487554794,
      "loss": 5.5201,
      "step": 19
    },
    {
      "epoch": 10.0,
      "grad_norm": 10.274887084960938,
      "learning_rate": 0.00022644418407952415,
      "loss": 5.6705,
      "step": 20
    },
    {
      "epoch": 10.5,
      "grad_norm": 9.752726554870605,
      "learning_rate": 0.00023776639328350037,
      "loss": 5.6533,
      "step": 21
    },
    {
      "epoch": 11.0,
      "grad_norm": 8.770606994628906,
      "learning_rate": 0.0002490886024874766,
      "loss": 5.9112,
      "step": 22
    },
    {
      "epoch": 11.5,
      "grad_norm": 6.886833190917969,
      "learning_rate": 0.00026041081169145275,
      "loss": 5.83,
      "step": 23
    },
    {
      "epoch": 12.0,
      "grad_norm": 7.6288042068481445,
      "learning_rate": 0.00027173302089542896,
      "loss": 5.7096,
      "step": 24
    },
    {
      "epoch": 12.5,
      "grad_norm": 7.881557464599609,
      "learning_rate": 0.0002830552300994052,
      "loss": 5.7564,
      "step": 25
    },
    {
      "epoch": 13.0,
      "grad_norm": 7.061491012573242,
      "learning_rate": 0.0002943774393033814,
      "loss": 5.7898,
      "step": 26
    },
    {
      "epoch": 13.5,
      "grad_norm": 6.147385597229004,
      "learning_rate": 0.0003056996485073576,
      "loss": 5.8308,
      "step": 27
    },
    {
      "epoch": 14.0,
      "grad_norm": 6.858682632446289,
      "learning_rate": 0.0003170218577113338,
      "loss": 5.8598,
      "step": 28
    },
    {
      "epoch": 14.5,
      "grad_norm": 6.384204387664795,
      "learning_rate": 0.00032834406691531,
      "loss": 6.0646,
      "step": 29
    },
    {
      "epoch": 15.0,
      "grad_norm": 7.964129447937012,
      "learning_rate": 0.00033966627611928626,
      "loss": 5.4971,
      "step": 30
    },
    {
      "epoch": 15.5,
      "grad_norm": 6.93912410736084,
      "learning_rate": 0.0003509884853232625,
      "loss": 5.7982,
      "step": 31
    },
    {
      "epoch": 16.0,
      "grad_norm": 8.229978561401367,
      "learning_rate": 0.0003623106945272387,
      "loss": 6.1515,
      "step": 32
    },
    {
      "epoch": 16.5,
      "grad_norm": 7.422101020812988,
      "learning_rate": 0.00037363290373121485,
      "loss": 5.834,
      "step": 33
    },
    {
      "epoch": 17.0,
      "grad_norm": 8.100040435791016,
      "learning_rate": 0.00038495511293519107,
      "loss": 6.1117,
      "step": 34
    },
    {
      "epoch": 17.5,
      "grad_norm": 6.303481101989746,
      "learning_rate": 0.0003962773221391673,
      "loss": 5.9096,
      "step": 35
    },
    {
      "epoch": 18.0,
      "grad_norm": 9.03445816040039,
      "learning_rate": 0.0004075995313431435,
      "loss": 5.8715,
      "step": 36
    },
    {
      "epoch": 18.5,
      "grad_norm": 7.390920162200928,
      "learning_rate": 0.0004189217405471197,
      "loss": 5.841,
      "step": 37
    },
    {
      "epoch": 19.0,
      "grad_norm": 10.36683177947998,
      "learning_rate": 0.0004302439497510959,
      "loss": 5.8436,
      "step": 38
    },
    {
      "epoch": 19.5,
      "grad_norm": 8.753049850463867,
      "learning_rate": 0.0004415661589550721,
      "loss": 6.0018,
      "step": 39
    },
    {
      "epoch": 20.0,
      "grad_norm": 8.968888282775879,
      "learning_rate": 0.0004528883681590483,
      "loss": 5.8143,
      "step": 40
    },
    {
      "epoch": 20.5,
      "grad_norm": 8.091390609741211,
      "learning_rate": 0.00046421057736302447,
      "loss": 6.205,
      "step": 41
    },
    {
      "epoch": 21.0,
      "grad_norm": 10.82010269165039,
      "learning_rate": 0.00047553278656700074,
      "loss": 5.7087,
      "step": 42
    },
    {
      "epoch": 21.5,
      "grad_norm": 7.038151264190674,
      "learning_rate": 0.0004868549957709769,
      "loss": 5.9671,
      "step": 43
    },
    {
      "epoch": 22.0,
      "grad_norm": 11.506723403930664,
      "learning_rate": 0.0004981772049749532,
      "loss": 5.8101,
      "step": 44
    },
    {
      "epoch": 22.5,
      "grad_norm": 7.887283802032471,
      "learning_rate": 0.0005094994141789294,
      "loss": 5.9632,
      "step": 45
    },
    {
      "epoch": 23.0,
      "grad_norm": 9.49548625946045,
      "learning_rate": 0.0005208216233829055,
      "loss": 6.0334,
      "step": 46
    },
    {
      "epoch": 23.5,
      "grad_norm": 9.5459623336792,
      "learning_rate": 0.0005321438325868818,
      "loss": 5.7936,
      "step": 47
    },
    {
      "epoch": 24.0,
      "grad_norm": 9.671682357788086,
      "learning_rate": 0.0005434660417908579,
      "loss": 6.2715,
      "step": 48
    },
    {
      "epoch": 24.5,
      "grad_norm": 7.273718357086182,
      "learning_rate": 0.0005547882509948343,
      "loss": 5.9485,
      "step": 49
    },
    {
      "epoch": 25.0,
      "grad_norm": 9.610321044921875,
      "learning_rate": 0.0005661104601988104,
      "loss": 5.996,
      "step": 50
    },
    {
      "epoch": 25.5,
      "grad_norm": 7.732569217681885,
      "learning_rate": 0.0005774326694027866,
      "loss": 5.9023,
      "step": 51
    },
    {
      "epoch": 26.0,
      "grad_norm": 9.702706336975098,
      "learning_rate": 0.0005887548786067628,
      "loss": 5.9072,
      "step": 52
    },
    {
      "epoch": 26.5,
      "grad_norm": 7.771154880523682,
      "learning_rate": 0.000600077087810739,
      "loss": 6.0866,
      "step": 53
    },
    {
      "epoch": 27.0,
      "grad_norm": 9.33850383758545,
      "learning_rate": 0.0006113992970147152,
      "loss": 5.9437,
      "step": 54
    },
    {
      "epoch": 27.5,
      "grad_norm": 7.285964488983154,
      "learning_rate": 0.0006227215062186914,
      "loss": 5.928,
      "step": 55
    },
    {
      "epoch": 28.0,
      "grad_norm": 10.876039505004883,
      "learning_rate": 0.0006340437154226675,
      "loss": 5.9707,
      "step": 56
    },
    {
      "epoch": 28.5,
      "grad_norm": 7.7636518478393555,
      "learning_rate": 0.0006453659246266439,
      "loss": 6.023,
      "step": 57
    },
    {
      "epoch": 29.0,
      "grad_norm": 11.718853950500488,
      "learning_rate": 0.00065668813383062,
      "loss": 5.8665,
      "step": 58
    },
    {
      "epoch": 29.5,
      "grad_norm": 10.40552806854248,
      "learning_rate": 0.0006680103430345963,
      "loss": 5.9438,
      "step": 59
    },
    {
      "epoch": 30.0,
      "grad_norm": 11.117144584655762,
      "learning_rate": 0.0006793325522385725,
      "loss": 6.2276,
      "step": 60
    },
    {
      "epoch": 30.5,
      "grad_norm": 9.187475204467773,
      "learning_rate": 0.0006906547614425486,
      "loss": 5.9205,
      "step": 61
    },
    {
      "epoch": 31.0,
      "grad_norm": 10.935819625854492,
      "learning_rate": 0.000701976970646525,
      "loss": 5.8297,
      "step": 62
    },
    {
      "epoch": 31.5,
      "grad_norm": 9.934367179870605,
      "learning_rate": 0.0007132991798505011,
      "loss": 5.844,
      "step": 63
    },
    {
      "epoch": 32.0,
      "grad_norm": 13.403008460998535,
      "learning_rate": 0.0007246213890544774,
      "loss": 6.251,
      "step": 64
    },
    {
      "epoch": 32.5,
      "grad_norm": 8.224946975708008,
      "learning_rate": 0.0007359435982584535,
      "loss": 6.068,
      "step": 65
    },
    {
      "epoch": 33.0,
      "grad_norm": 12.883185386657715,
      "learning_rate": 0.0007472658074624297,
      "loss": 5.7404,
      "step": 66
    },
    {
      "epoch": 33.5,
      "grad_norm": 9.312764167785645,
      "learning_rate": 0.0007585880166664059,
      "loss": 5.9124,
      "step": 67
    },
    {
      "epoch": 34.0,
      "grad_norm": 12.291579246520996,
      "learning_rate": 0.0007699102258703821,
      "loss": 5.9891,
      "step": 68
    },
    {
      "epoch": 34.5,
      "grad_norm": 10.672759056091309,
      "learning_rate": 0.0007812324350743584,
      "loss": 6.0152,
      "step": 69
    },
    {
      "epoch": 35.0,
      "grad_norm": 14.083620071411133,
      "learning_rate": 0.0007925546442783346,
      "loss": 5.7741,
      "step": 70
    },
    {
      "epoch": 35.5,
      "grad_norm": 11.28048038482666,
      "learning_rate": 0.0008038768534823107,
      "loss": 6.0165,
      "step": 71
    },
    {
      "epoch": 36.0,
      "grad_norm": 15.007305145263672,
      "learning_rate": 0.000815199062686287,
      "loss": 5.8658,
      "step": 72
    },
    {
      "epoch": 36.5,
      "grad_norm": 10.744963645935059,
      "learning_rate": 0.0008265212718902631,
      "loss": 6.1574,
      "step": 73
    },
    {
      "epoch": 37.0,
      "grad_norm": 14.339564323425293,
      "learning_rate": 0.0008378434810942394,
      "loss": 5.6168,
      "step": 74
    },
    {
      "epoch": 37.5,
      "grad_norm": 9.563307762145996,
      "learning_rate": 0.0008491656902982155,
      "loss": 6.1834,
      "step": 75
    },
    {
      "epoch": 38.0,
      "grad_norm": 18.125316619873047,
      "learning_rate": 0.0008604878995021918,
      "loss": 5.705,
      "step": 76
    },
    {
      "epoch": 38.5,
      "grad_norm": 13.951987266540527,
      "learning_rate": 0.000871810108706168,
      "loss": 6.0306,
      "step": 77
    },
    {
      "epoch": 39.0,
      "grad_norm": 15.037321090698242,
      "learning_rate": 0.0008831323179101442,
      "loss": 5.8313,
      "step": 78
    },
    {
      "epoch": 39.5,
      "grad_norm": 11.429295539855957,
      "learning_rate": 0.0008944545271141204,
      "loss": 5.9332,
      "step": 79
    },
    {
      "epoch": 40.0,
      "grad_norm": 19.87891960144043,
      "learning_rate": 0.0009057767363180966,
      "loss": 6.0832,
      "step": 80
    },
    {
      "epoch": 40.0,
      "eval_brier_0th_event": 0.2039320351141016,
      "eval_brier_0th_event_n": 257,
      "eval_brier_avg": 0.2039320351141016,
      "eval_brier_weighted_avg": 0.2039320351141016,
      "eval_ipcw": 0.6035285629266591,
      "eval_ipcw_0th_event": 0.6035285629266591,
      "eval_ipcw_0th_event_0.25": 0.6336573120082982,
      "eval_ipcw_0th_event_0.5": 0.6271317466550901,
      "eval_ipcw_0th_event_0.75": 0.6139153814461576,
      "eval_ipcw_0th_event_1.0": 0.6035285629266591,
      "eval_ipcw_0th_event_n": 257,
      "eval_ipcw_avg": 0.6195582507590514,
      "eval_ipcw_avg_0th_event": 0.6195582507590514,
      "eval_ipcw_weighted_avg": 0.6195582507590514,
      "eval_loss": 3.476630687713623,
      "eval_runtime": 0.1049,
      "eval_samples_per_second": 4233.127,
      "eval_steps_per_second": 9.534,
      "step": 80
    },
    {
      "epoch": 40.5,
      "grad_norm": 13.56197452545166,
      "learning_rate": 0.0009057740958261967,
      "loss": 5.9595,
      "step": 81
    },
    {
      "epoch": 40.5,
      "eval_brier_0th_event": 0.20421951945702543,
      "eval_brier_0th_event_n": 257,
      "eval_brier_avg": 0.20421951945702543,
      "eval_brier_weighted_avg": 0.20421951945702543,
      "eval_ipcw": 0.5967864651618351,
      "eval_ipcw_0th_event": 0.5967864651618351,
      "eval_ipcw_0th_event_0.25": 0.6350511720781387,
      "eval_ipcw_0th_event_0.5": 0.629345894222889,
      "eval_ipcw_0th_event_0.75": 0.615065675801505,
      "eval_ipcw_0th_event_1.0": 0.5967864651618351,
      "eval_ipcw_0th_event_n": 257,
      "eval_ipcw_avg": 0.6190623018160919,
      "eval_ipcw_avg_0th_event": 0.6190623018160919,
      "eval_ipcw_weighted_avg": 0.6190623018160919,
      "eval_loss": 3.481262445449829,
      "eval_runtime": 0.0837,
      "eval_samples_per_second": 5306.129,
      "eval_steps_per_second": 11.951,
      "step": 81
    },
    {
      "epoch": 41.0,
      "grad_norm": 17.848005294799805,
      "learning_rate": 0.000905766174381287,
      "loss": 6.2791,
      "step": 82
    },
    {
      "epoch": 41.0,
      "eval_brier_0th_event": 0.2045254347352452,
      "eval_brier_0th_event_n": 257,
      "eval_brier_avg": 0.2045254347352452,
      "eval_brier_weighted_avg": 0.2045254347352452,
      "eval_ipcw": 0.5960757370787676,
      "eval_ipcw_0th_event": 0.5960757370787676,
      "eval_ipcw_0th_event_0.25": 0.6361513525578639,
      "eval_ipcw_0th_event_0.5": 0.63202682383229,
      "eval_ipcw_0th_event_0.75": 0.615486299572605,
      "eval_ipcw_0th_event_1.0": 0.5960757370787676,
      "eval_ipcw_0th_event_n": 257,
      "eval_ipcw_avg": 0.6199350532603817,
      "eval_ipcw_avg_0th_event": 0.6199350532603817,
      "eval_ipcw_weighted_avg": 0.6199350532603817,
      "eval_loss": 3.4451146125793457,
      "eval_runtime": 0.1009,
      "eval_samples_per_second": 4400.015,
      "eval_steps_per_second": 9.91,
      "step": 82
    },
    {
      "epoch": 41.5,
      "grad_norm": 14.233784675598145,
      "learning_rate": 0.0009057529720757368,
      "loss": 5.7855,
      "step": 83
    },
    {
      "epoch": 41.5,
      "eval_brier_0th_event": 0.20484908763002085,
      "eval_brier_0th_event_n": 257,
      "eval_brier_avg": 0.20484908763002085,
      "eval_brier_weighted_avg": 0.20484908763002085,
      "eval_ipcw": 0.5948771715631088,
      "eval_ipcw_0th_event": 0.5948771715631088,
      "eval_ipcw_0th_event_0.25": 0.6340586875714652,
      "eval_ipcw_0th_event_0.5": 0.6326620076307149,
      "eval_ipcw_0th_event_0.75": 0.6149173889675892,
      "eval_ipcw_0th_event_1.0": 0.5948771715631088,
      "eval_ipcw_0th_event_n": 257,
      "eval_ipcw_avg": 0.6191288139332195,
      "eval_ipcw_avg_0th_event": 0.6191288139332195,
      "eval_ipcw_weighted_avg": 0.6191288139332195,
      "eval_loss": 3.4750163555145264,
      "eval_runtime": 0.0812,
      "eval_samples_per_second": 5470.14,
      "eval_steps_per_second": 12.32,
      "step": 83
    },
    {
      "epoch": 42.0,
      "grad_norm": 16.12395477294922,
      "learning_rate": 0.0009057344890634937,
      "loss": 5.9921,
      "step": 84
    },
    {
      "epoch": 42.0,
      "eval_brier_0th_event": 0.20484995796643501,
      "eval_brier_0th_event_n": 257,
      "eval_brier_avg": 0.20484995796643501,
      "eval_brier_weighted_avg": 0.20484995796643501,
      "eval_ipcw": 0.5982293149712284,
      "eval_ipcw_0th_event": 0.5982293149712284,
      "eval_ipcw_0th_event_0.25": 0.635357754036268,
      "eval_ipcw_0th_event_0.5": 0.6337010172543789,
      "eval_ipcw_0th_event_0.75": 0.6161824798025074,
      "eval_ipcw_0th_event_1.0": 0.5982293149712284,
      "eval_ipcw_0th_event_n": 257,
      "eval_ipcw_avg": 0.6208676415160957,
      "eval_ipcw_avg_0th_event": 0.6208676415160957,
      "eval_ipcw_weighted_avg": 0.6208676415160957,
      "eval_loss": 3.4805071353912354,
      "eval_runtime": 0.0858,
      "eval_samples_per_second": 5172.788,
      "eval_steps_per_second": 11.65,
      "step": 84
    },
    {
      "epoch": 42.5,
      "grad_norm": 13.500887870788574,
      "learning_rate": 0.0009057107255600825,
      "loss": 5.9734,
      "step": 85
    },
    {
      "epoch": 42.5,
      "eval_brier_0th_event": 0.20481633566505356,
      "eval_brier_0th_event_n": 257,
      "eval_brier_avg": 0.20481633566505356,
      "eval_brier_weighted_avg": 0.20481633566505356,
      "eval_ipcw": 0.5991273040467353,
      "eval_ipcw_0th_event": 0.5991273040467353,
      "eval_ipcw_0th_event_0.25": 0.6368275669684527,
      "eval_ipcw_0th_event_0.5": 0.6347729744078715,
      "eval_ipcw_0th_event_0.75": 0.6172043554456965,
      "eval_ipcw_0th_event_1.0": 0.5991273040467353,
      "eval_ipcw_0th_event_n": 257,
      "eval_ipcw_avg": 0.621983050217189,
      "eval_ipcw_avg_0th_event": 0.621983050217189,
      "eval_ipcw_weighted_avg": 0.621983050217189,
      "eval_loss": 3.492149591445923,
      "eval_runtime": 0.1044,
      "eval_samples_per_second": 4251.285,
      "eval_steps_per_second": 9.575,
      "step": 85
    }
  ],
  "logging_steps": 1,
  "max_steps": 1000,
  "num_input_tokens_seen": 0,
  "num_train_epochs": 500,
  "save_steps": 1,
  "stateful_callbacks": {
    "EarlyStoppingCallback": {
      "args": {
        "early_stopping_patience": 10,
        "early_stopping_threshold": 0.0
      },
      "attributes": {
        "early_stopping_patience_counter": 0
      }
    },
    "TrainerControl": {
      "args": {
        "should_epoch_stop": false,
        "should_evaluate": false,
        "should_log": false,
        "should_save": true,
        "should_training_stop": false
      },
      "attributes": {}
    }
  },
  "total_flos": 52583366400.0,
  "train_batch_size": 256,
  "trial_name": null,
  "trial_params": null
}
