{
  "best_global_step": 85,
  "best_metric": 0.548869088092177,
  "best_model_checkpoint": "./data/model-hub/metabric/deephit_trial_1744624566/checkpoint-85",
  "epoch": 42.5,
  "eval_steps": 1,
  "global_step": 85,
  "is_hyper_param_search": false,
  "is_local_process_zero": true,
  "is_world_process_zero": true,
  "log_history": [
    {
      "epoch": 0.5,
      "grad_norm": 2.7530100345611572,
      "learning_rate": 3.062325083159522e-07,
      "loss": 5.9025,
      "step": 1
    },
    {
      "epoch": 1.0,
      "grad_norm": 2.9645028114318848,
      "learning_rate": 6.124650166319044e-07,
      "loss": 6.0597,
      "step": 2
    },
    {
      "epoch": 1.5,
      "grad_norm": 2.3971974849700928,
      "learning_rate": 9.186975249478564e-07,
      "loss": 5.3726,
      "step": 3
    },
    {
      "epoch": 2.0,
      "grad_norm": 3.1737546920776367,
      "learning_rate": 1.2249300332638087e-06,
      "loss": 5.455,
      "step": 4
    },
    {
      "epoch": 2.5,
      "grad_norm": 2.789485454559326,
      "learning_rate": 1.5311625415797608e-06,
      "loss": 5.1593,
      "step": 5
    },
    {
      "epoch": 3.0,
      "grad_norm": 3.2605507373809814,
      "learning_rate": 1.837395049895713e-06,
      "loss": 5.0823,
      "step": 6
    },
    {
      "epoch": 3.5,
      "grad_norm": 2.8974616527557373,
      "learning_rate": 2.143627558211665e-06,
      "loss": 5.0921,
      "step": 7
    },
    {
      "epoch": 4.0,
      "grad_norm": 2.875185251235962,
      "learning_rate": 2.4498600665276175e-06,
      "loss": 5.1563,
      "step": 8
    },
    {
      "epoch": 4.5,
      "grad_norm": 3.4193503856658936,
      "learning_rate": 2.7560925748435696e-06,
      "loss": 5.0767,
      "step": 9
    },
    {
      "epoch": 5.0,
      "grad_norm": 3.1202595233917236,
      "learning_rate": 3.0623250831595216e-06,
      "loss": 5.2963,
      "step": 10
    },
    {
      "epoch": 5.5,
      "grad_norm": 4.653514385223389,
      "learning_rate": 3.368557591475474e-06,
      "loss": 5.2174,
      "step": 11
    },
    {
      "epoch": 6.0,
      "grad_norm": 3.6954057216644287,
      "learning_rate": 3.674790099791426e-06,
      "loss": 5.4294,
      "step": 12
    },
    {
      "epoch": 6.5,
      "grad_norm": 6.123569965362549,
      "learning_rate": 3.981022608107378e-06,
      "loss": 5.4229,
      "step": 13
    },
    {
      "epoch": 7.0,
      "grad_norm": 5.195865154266357,
      "learning_rate": 4.28725511642333e-06,
      "loss": 5.5664,
      "step": 14
    },
    {
      "epoch": 7.5,
      "grad_norm": 5.252265930175781,
      "learning_rate": 4.593487624739283e-06,
      "loss": 5.5642,
      "step": 15
    },
    {
      "epoch": 8.0,
      "grad_norm": 5.282036781311035,
      "learning_rate": 4.899720133055235e-06,
      "loss": 5.6752,
      "step": 16
    },
    {
      "epoch": 8.5,
      "grad_norm": 5.05621337890625,
      "learning_rate": 5.205952641371187e-06,
      "loss": 5.7059,
      "step": 17
    },
    {
      "epoch": 9.0,
      "grad_norm": 4.645510673522949,
      "learning_rate": 5.512185149687139e-06,
      "loss": 5.717,
      "step": 18
    },
    {
      "epoch": 9.5,
      "grad_norm": 4.905003070831299,
      "learning_rate": 5.818417658003091e-06,
      "loss": 5.873,
      "step": 19
    },
    {
      "epoch": 10.0,
      "grad_norm": 4.313572883605957,
      "learning_rate": 6.124650166319043e-06,
      "loss": 5.6683,
      "step": 20
    },
    {
      "epoch": 10.5,
      "grad_norm": 4.979708671569824,
      "learning_rate": 6.430882674634995e-06,
      "loss": 5.9003,
      "step": 21
    },
    {
      "epoch": 11.0,
      "grad_norm": 5.663119316101074,
      "learning_rate": 6.737115182950948e-06,
      "loss": 5.9421,
      "step": 22
    },
    {
      "epoch": 11.5,
      "grad_norm": 5.546401500701904,
      "learning_rate": 7.0433476912668995e-06,
      "loss": 5.8968,
      "step": 23
    },
    {
      "epoch": 12.0,
      "grad_norm": 5.9464311599731445,
      "learning_rate": 7.349580199582852e-06,
      "loss": 5.9243,
      "step": 24
    },
    {
      "epoch": 12.5,
      "grad_norm": 5.922446250915527,
      "learning_rate": 7.655812707898804e-06,
      "loss": 5.8882,
      "step": 25
    },
    {
      "epoch": 13.0,
      "grad_norm": 4.6922502517700195,
      "learning_rate": 7.962045216214756e-06,
      "loss": 6.0055,
      "step": 26
    },
    {
      "epoch": 13.5,
      "grad_norm": 5.280735969543457,
      "learning_rate": 8.26827772453071e-06,
      "loss": 5.9101,
      "step": 27
    },
    {
      "epoch": 14.0,
      "grad_norm": 5.733696937561035,
      "learning_rate": 8.57451023284666e-06,
      "loss": 6.0854,
      "step": 28
    },
    {
      "epoch": 14.5,
      "grad_norm": 7.638872146606445,
      "learning_rate": 8.880742741162612e-06,
      "loss": 5.9685,
      "step": 29
    },
    {
      "epoch": 15.0,
      "grad_norm": 5.979971408843994,
      "learning_rate": 9.186975249478566e-06,
      "loss": 5.9056,
      "step": 30
    },
    {
      "epoch": 15.5,
      "grad_norm": 5.087390899658203,
      "learning_rate": 9.493207757794518e-06,
      "loss": 5.8993,
      "step": 31
    },
    {
      "epoch": 16.0,
      "grad_norm": 5.514225959777832,
      "learning_rate": 9.79944026611047e-06,
      "loss": 6.08,
      "step": 32
    },
    {
      "epoch": 16.5,
      "grad_norm": 5.929417133331299,
      "learning_rate": 1.010567277442642e-05,
      "loss": 5.9695,
      "step": 33
    },
    {
      "epoch": 17.0,
      "grad_norm": 6.1263427734375,
      "learning_rate": 1.0411905282742374e-05,
      "loss": 5.956,
      "step": 34
    },
    {
      "epoch": 17.5,
      "grad_norm": 4.8472161293029785,
      "learning_rate": 1.0718137791058326e-05,
      "loss": 6.0357,
      "step": 35
    },
    {
      "epoch": 18.0,
      "grad_norm": 6.2133307456970215,
      "learning_rate": 1.1024370299374278e-05,
      "loss": 5.9462,
      "step": 36
    },
    {
      "epoch": 18.5,
      "grad_norm": 5.246607303619385,
      "learning_rate": 1.133060280769023e-05,
      "loss": 6.0931,
      "step": 37
    },
    {
      "epoch": 19.0,
      "grad_norm": 6.830187797546387,
      "learning_rate": 1.1636835316006182e-05,
      "loss": 5.7681,
      "step": 38
    },
    {
      "epoch": 19.5,
      "grad_norm": 5.676294803619385,
      "learning_rate": 1.1943067824322134e-05,
      "loss": 5.9601,
      "step": 39
    },
    {
      "epoch": 20.0,
      "grad_norm": 6.455917835235596,
      "learning_rate": 1.2249300332638087e-05,
      "loss": 6.1237,
      "step": 40
    },
    {
      "epoch": 20.5,
      "grad_norm": 6.852622032165527,
      "learning_rate": 1.2555532840954037e-05,
      "loss": 5.9552,
      "step": 41
    },
    {
      "epoch": 21.0,
      "grad_norm": 5.056720733642578,
      "learning_rate": 1.286176534926999e-05,
      "loss": 6.0224,
      "step": 42
    },
    {
      "epoch": 21.5,
      "grad_norm": 6.362083911895752,
      "learning_rate": 1.3167997857585943e-05,
      "loss": 5.9328,
      "step": 43
    },
    {
      "epoch": 22.0,
      "grad_norm": 5.9006266593933105,
      "learning_rate": 1.3474230365901897e-05,
      "loss": 6.0692,
      "step": 44
    },
    {
      "epoch": 22.5,
      "grad_norm": 5.68513298034668,
      "learning_rate": 1.3780462874217847e-05,
      "loss": 5.9711,
      "step": 45
    },
    {
      "epoch": 23.0,
      "grad_norm": 4.973100185394287,
      "learning_rate": 1.4086695382533799e-05,
      "loss": 6.0042,
      "step": 46
    },
    {
      "epoch": 23.5,
      "grad_norm": 6.057908535003662,
      "learning_rate": 1.4392927890849753e-05,
      "loss": 5.9083,
      "step": 47
    },
    {
      "epoch": 24.0,
      "grad_norm": 5.630420207977295,
      "learning_rate": 1.4699160399165703e-05,
      "loss": 6.029,
      "step": 48
    },
    {
      "epoch": 24.5,
      "grad_norm": 4.773608684539795,
      "learning_rate": 1.5005392907481657e-05,
      "loss": 6.0079,
      "step": 49
    },
    {
      "epoch": 25.0,
      "grad_norm": 4.222045421600342,
      "learning_rate": 1.5311625415797607e-05,
      "loss": 6.0063,
      "step": 50
    },
    {
      "epoch": 25.5,
      "grad_norm": 4.556630611419678,
      "learning_rate": 1.561785792411356e-05,
      "loss": 6.0808,
      "step": 51
    },
    {
      "epoch": 26.0,
      "grad_norm": 4.528476238250732,
      "learning_rate": 1.592409043242951e-05,
      "loss": 5.8831,
      "step": 52
    },
    {
      "epoch": 26.5,
      "grad_norm": 4.478783130645752,
      "learning_rate": 1.6230322940745464e-05,
      "loss": 6.1083,
      "step": 53
    },
    {
      "epoch": 27.0,
      "grad_norm": 5.958902359008789,
      "learning_rate": 1.653655544906142e-05,
      "loss": 5.7503,
      "step": 54
    },
    {
      "epoch": 27.5,
      "grad_norm": 5.404911518096924,
      "learning_rate": 1.6842787957377368e-05,
      "loss": 5.9848,
      "step": 55
    },
    {
      "epoch": 28.0,
      "grad_norm": 3.992711067199707,
      "learning_rate": 1.714902046569332e-05,
      "loss": 6.0153,
      "step": 56
    },
    {
      "epoch": 28.5,
      "grad_norm": 4.840831756591797,
      "learning_rate": 1.7455252974009275e-05,
      "loss": 5.9421,
      "step": 57
    },
    {
      "epoch": 29.0,
      "grad_norm": 5.481813430786133,
      "learning_rate": 1.7761485482325224e-05,
      "loss": 6.0552,
      "step": 58
    },
    {
      "epoch": 29.5,
      "grad_norm": 4.347405910491943,
      "learning_rate": 1.806771799064118e-05,
      "loss": 6.166,
      "step": 59
    },
    {
      "epoch": 30.0,
      "grad_norm": 5.8552446365356445,
      "learning_rate": 1.837395049895713e-05,
      "loss": 5.7646,
      "step": 60
    },
    {
      "epoch": 30.5,
      "grad_norm": 5.027132034301758,
      "learning_rate": 1.868018300727308e-05,
      "loss": 6.0212,
      "step": 61
    },
    {
      "epoch": 31.0,
      "grad_norm": 5.316928863525391,
      "learning_rate": 1.8986415515589036e-05,
      "loss": 6.0474,
      "step": 62
    },
    {
      "epoch": 31.5,
      "grad_norm": 5.294946193695068,
      "learning_rate": 1.9292648023904984e-05,
      "loss": 5.996,
      "step": 63
    },
    {
      "epoch": 32.0,
      "grad_norm": 4.921106815338135,
      "learning_rate": 1.959888053222094e-05,
      "loss": 6.0388,
      "step": 64
    },
    {
      "epoch": 32.5,
      "grad_norm": 4.578653335571289,
      "learning_rate": 1.9905113040536892e-05,
      "loss": 6.0505,
      "step": 65
    },
    {
      "epoch": 33.0,
      "grad_norm": 4.973858833312988,
      "learning_rate": 2.021134554885284e-05,
      "loss": 5.7774,
      "step": 66
    },
    {
      "epoch": 33.5,
      "grad_norm": 3.7599575519561768,
      "learning_rate": 2.0517578057168796e-05,
      "loss": 5.9716,
      "step": 67
    },
    {
      "epoch": 34.0,
      "grad_norm": 5.002325057983398,
      "learning_rate": 2.0823810565484748e-05,
      "loss": 6.1202,
      "step": 68
    },
    {
      "epoch": 34.5,
      "grad_norm": 4.578815460205078,
      "learning_rate": 2.11300430738007e-05,
      "loss": 5.9809,
      "step": 69
    },
    {
      "epoch": 35.0,
      "grad_norm": 5.111495018005371,
      "learning_rate": 2.1436275582116652e-05,
      "loss": 6.081,
      "step": 70
    },
    {
      "epoch": 35.5,
      "grad_norm": 4.393256187438965,
      "learning_rate": 2.17425080904326e-05,
      "loss": 5.9722,
      "step": 71
    },
    {
      "epoch": 36.0,
      "grad_norm": 4.652942180633545,
      "learning_rate": 2.2048740598748556e-05,
      "loss": 5.992,
      "step": 72
    },
    {
      "epoch": 36.5,
      "grad_norm": 4.301990985870361,
      "learning_rate": 2.235497310706451e-05,
      "loss": 6.0298,
      "step": 73
    },
    {
      "epoch": 37.0,
      "grad_norm": 4.755440711975098,
      "learning_rate": 2.266120561538046e-05,
      "loss": 6.0216,
      "step": 74
    },
    {
      "epoch": 37.5,
      "grad_norm": 4.693880081176758,
      "learning_rate": 2.2967438123696413e-05,
      "loss": 5.9968,
      "step": 75
    },
    {
      "epoch": 38.0,
      "grad_norm": 4.8868913650512695,
      "learning_rate": 2.3273670632012365e-05,
      "loss": 5.958,
      "step": 76
    },
    {
      "epoch": 38.5,
      "grad_norm": 4.310656547546387,
      "learning_rate": 2.3579903140328317e-05,
      "loss": 5.9687,
      "step": 77
    },
    {
      "epoch": 39.0,
      "grad_norm": 3.725715160369873,
      "learning_rate": 2.388613564864427e-05,
      "loss": 5.9686,
      "step": 78
    },
    {
      "epoch": 39.5,
      "grad_norm": 4.120896816253662,
      "learning_rate": 2.419236815696022e-05,
      "loss": 6.015,
      "step": 79
    },
    {
      "epoch": 40.0,
      "grad_norm": 3.5841996669769287,
      "learning_rate": 2.4498600665276173e-05,
      "loss": 5.9873,
      "step": 80
    },
    {
      "epoch": 40.0,
      "eval_brier_0th_event": 0.22543798489614614,
      "eval_brier_0th_event_n": 257,
      "eval_brier_avg": 0.22543798489614614,
      "eval_brier_weighted_avg": 0.22543798489614614,
      "eval_ipcw": 0.5514749732638492,
      "eval_ipcw_0th_event": 0.5514749732638492,
      "eval_ipcw_0th_event_0.25": 0.5480063547405636,
      "eval_ipcw_0th_event_0.5": 0.5443755412051665,
      "eval_ipcw_0th_event_0.75": 0.5385635705966679,
      "eval_ipcw_0th_event_1.0": 0.5514749732638492,
      "eval_ipcw_0th_event_n": 257,
      "eval_ipcw_avg": 0.5456051099515619,
      "eval_ipcw_avg_0th_event": 0.5456051099515619,
      "eval_ipcw_weighted_avg": 0.5456051099515619,
      "eval_loss": 3.0230939388275146,
      "eval_runtime": 0.0982,
      "eval_samples_per_second": 4522.172,
      "eval_steps_per_second": 10.185,
      "step": 80
    },
    {
      "epoch": 40.5,
      "grad_norm": 4.1541547775268555,
      "learning_rate": 2.4498529247724782e-05,
      "loss": 6.041,
      "step": 81
    },
    {
      "epoch": 40.5,
      "eval_brier_0th_event": 0.22533495584903715,
      "eval_brier_0th_event_n": 257,
      "eval_brier_avg": 0.22533495584903715,
      "eval_brier_weighted_avg": 0.22533495584903715,
      "eval_ipcw": 0.5518228498776362,
      "eval_ipcw_0th_event": 0.5518228498776362,
      "eval_ipcw_0th_event_0.25": 0.5486211290922838,
      "eval_ipcw_0th_event_0.5": 0.5457012592879005,
      "eval_ipcw_0th_event_0.75": 0.5387824322169308,
      "eval_ipcw_0th_event_1.0": 0.5518228498776362,
      "eval_ipcw_0th_event_n": 257,
      "eval_ipcw_avg": 0.5462319176186878,
      "eval_ipcw_avg_0th_event": 0.5462319176186878,
      "eval_ipcw_weighted_avg": 0.5462319176186878,
      "eval_loss": 3.01716685295105,
      "eval_runtime": 0.0849,
      "eval_samples_per_second": 5228.088,
      "eval_steps_per_second": 11.775,
      "step": 81
    },
    {
      "epoch": 41.0,
      "grad_norm": 4.252668380737305,
      "learning_rate": 2.4498314995903383e-05,
      "loss": 5.9623,
      "step": 82
    },
    {
      "epoch": 41.0,
      "eval_brier_0th_event": 0.22523288897204072,
      "eval_brier_0th_event_n": 257,
      "eval_brier_avg": 0.22523288897204072,
      "eval_brier_weighted_avg": 0.22523288897204072,
      "eval_ipcw": 0.5520338561217412,
      "eval_ipcw_0th_event": 0.5520338561217412,
      "eval_ipcw_0th_event_0.25": 0.5491525141854829,
      "eval_ipcw_0th_event_0.5": 0.5469770898778596,
      "eval_ipcw_0th_event_0.75": 0.5394996854769069,
      "eval_ipcw_0th_event_1.0": 0.5520338561217412,
      "eval_ipcw_0th_event_n": 257,
      "eval_ipcw_avg": 0.5469157864154977,
      "eval_ipcw_avg_0th_event": 0.5469157864154977,
      "eval_ipcw_weighted_avg": 0.5469157864154977,
      "eval_loss": 3.0205748081207275,
      "eval_runtime": 0.099,
      "eval_samples_per_second": 4483.543,
      "eval_steps_per_second": 10.098,
      "step": 82
    },
    {
      "epoch": 41.5,
      "grad_norm": 3.721986770629883,
      "learning_rate": 2.4497957912310298e-05,
      "loss": 6.0216,
      "step": 83
    },
    {
      "epoch": 41.5,
      "eval_brier_0th_event": 0.22513092531152581,
      "eval_brier_0th_event_n": 257,
      "eval_brier_avg": 0.22513092531152581,
      "eval_brier_weighted_avg": 0.22513092531152581,
      "eval_ipcw": 0.5532391774967858,
      "eval_ipcw_0th_event": 0.5532391774967858,
      "eval_ipcw_0th_event_0.25": 0.5494821745873596,
      "eval_ipcw_0th_event_0.5": 0.5476464085687545,
      "eval_ipcw_0th_event_0.75": 0.5399639489314413,
      "eval_ipcw_0th_event_1.0": 0.5532391774967858,
      "eval_ipcw_0th_event_n": 257,
      "eval_ipcw_avg": 0.5475829273960853,
      "eval_ipcw_avg_0th_event": 0.5475829273960853,
      "eval_ipcw_weighted_avg": 0.5475829273960853,
      "eval_loss": 3.0169870853424072,
      "eval_runtime": 0.1013,
      "eval_samples_per_second": 4380.866,
      "eval_steps_per_second": 9.867,
      "step": 83
    },
    {
      "epoch": 42.0,
      "grad_norm": 4.539219379425049,
      "learning_rate": 2.4497458001109365e-05,
      "loss": 5.8997,
      "step": 84
    },
    {
      "epoch": 42.0,
      "eval_brier_0th_event": 0.22503208101341143,
      "eval_brier_0th_event_n": 257,
      "eval_brier_avg": 0.22503208101341143,
      "eval_brier_weighted_avg": 0.22503208101341143,
      "eval_ipcw": 0.5549389824668858,
      "eval_ipcw_0th_event": 0.5549389824668858,
      "eval_ipcw_0th_event_0.25": 0.5498248689158742,
      "eval_ipcw_0th_event_0.5": 0.5487078965114075,
      "eval_ipcw_0th_event_0.75": 0.5401374320922976,
      "eval_ipcw_0th_event_1.0": 0.5549389824668858,
      "eval_ipcw_0th_event_n": 257,
      "eval_ipcw_avg": 0.5484022949966163,
      "eval_ipcw_avg_0th_event": 0.5484022949966163,
      "eval_ipcw_weighted_avg": 0.5484022949966163,
      "eval_loss": 3.0274174213409424,
      "eval_runtime": 0.0976,
      "eval_samples_per_second": 4550.715,
      "eval_steps_per_second": 10.249,
      "step": 84
    },
    {
      "epoch": 42.5,
      "grad_norm": 3.43264102935791,
      "learning_rate": 2.449681526812988e-05,
      "loss": 5.9007,
      "step": 85
    },
    {
      "epoch": 42.5,
      "eval_brier_0th_event": 0.22493358226998447,
      "eval_brier_0th_event_n": 257,
      "eval_brier_avg": 0.22493358226998447,
      "eval_brier_weighted_avg": 0.22493358226998447,
      "eval_ipcw": 0.5551166633160348,
      "eval_ipcw_0th_event": 0.5551166633160348,
      "eval_ipcw_0th_event_0.25": 0.5506414995877825,
      "eval_ipcw_0th_event_0.5": 0.5495227564593065,
      "eval_ipcw_0th_event_0.75": 0.5401954330055841,
      "eval_ipcw_0th_event_1.0": 0.5551166633160348,
      "eval_ipcw_0th_event_n": 257,
      "eval_ipcw_avg": 0.548869088092177,
      "eval_ipcw_avg_0th_event": 0.548869088092177,
      "eval_ipcw_weighted_avg": 0.548869088092177,
      "eval_loss": 3.037874698638916,
      "eval_runtime": 0.0928,
      "eval_samples_per_second": 4785.557,
      "eval_steps_per_second": 10.778,
      "step": 85
    }
  ],
  "logging_steps": 1,
  "max_steps": 1000,
  "num_input_tokens_seen": 0,
  "num_train_epochs": 500,
  "save_steps": 1,
  "stateful_callbacks": {
    "EarlyStoppingCallback": {
      "args": {
        "early_stopping_patience": 10,
        "early_stopping_threshold": 0.0
      },
      "attributes": {
        "early_stopping_patience_counter": 0
      }
    },
    "TrainerControl": {
      "args": {
        "should_epoch_stop": false,
        "should_evaluate": false,
        "should_log": false,
        "should_save": true,
        "should_training_stop": false
      },
      "attributes": {}
    }
  },
  "total_flos": 20752055040.0,
  "train_batch_size": 256,
  "trial_name": null,
  "trial_params": null
}
